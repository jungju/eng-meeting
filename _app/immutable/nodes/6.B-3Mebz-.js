import"../chunks/NZTpNUN0.js";import{i as Xe}from"../chunks/C1kFBjD0.js";import{p as Fe,a3 as i,a4 as Je,t as g,f as ie,a as m,b as Pe,g as e,d as r,s as b,o as a,a5 as Qe,a8 as Ye,m as ke,e as v,r as d,a9 as Ze,h as R,i as A,a6 as V,K as et}from"../chunks/kc4YAh9y.js";import{i as B}from"../chunks/meG6WkfV.js";import{e as tt,i as at}from"../chunks/BvPctM3R.js";import{s as rt}from"../chunks/D8RCsmFZ.js";import{b as st}from"../chunks/eT6sziqz.js";import{s as nt,a as ot}from"../chunks/CxXm-2W8.js";import{o as it,a as lt}from"../chunks/B6AwUu_V.js";import{p as pt}from"../chunks/D9AVJ2rP.js";import{b as ct}from"../chunks/CIf4UdPx.js";import{C as vt}from"../chunks/Dw7rxz5s.js";var dt=g('<div class="remain-big svelte-164rmpq"> </div>'),ft=g('<p class="kor svelte-164rmpq"> </p>'),ut=g('<p class="eng svelte-164rmpq"> </p>'),mt=g('<p class="eng svelte-164rmpq"> </p>'),gt=g('<p class="placeholder svelte-164rmpq">•••</p>'),_t=g("<!> <!>",1),ht=g('<div role="button" tabindex="0"><div class="order-big svelte-164rmpq"> </div> <!> <!></div> <button class="next-btn svelte-164rmpq">NEXT ⏭</button>',1),bt=g('<div class="result-item svelte-164rmpq" role="button" tabindex="0"><span class="num svelte-164rmpq"></span> <span class="eng txt svelte-164rmpq"> </span> <span class="kor txt svelte-164rmpq"> </span></div>'),kt=g('<div class="result-list svelte-164rmpq"><h2 class="svelte-164rmpq">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),xt=g('<main class="wrapper svelte-164rmpq"><!></main> <!> <audio playsinline="" preload="auto" class="svelte-164rmpq"></audio>',1);function jt(xe,ye){Fe(ye,!1);const[we,qe]=nt(),le=()=>ot(pt,"$page",we),Z=r(),D=r(),pe=r(),ce=r(),k=r(),_=r(),ve=r(),de=r(),ee=r(),te=r(),X=r(),ae=r(),re=r(),fe=r(),ue=[1e4,2e4,3e4,-1],me=[10,20,50,-1];let F=r(0),J=r(0),x=r([]),se=r([]),p=r(-1),P=r(0),l=r(),y=r(!1),w=r(!1),M=!1,C=r(0),j,N=r(!1);const q=new Set;let E=r([]),f=r(1),c=r(0);it(()=>(fetch(`${e(D)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a(x,t.sentences),a(se,t.korean))}),window.addEventListener("keydown",ge),()=>window.removeEventListener("keydown",ge))),lt(()=>{e(l)?.pause(),clearInterval(j)});function ge(t){if(!e(N)){if(["Space","ArrowRight"].includes(t.code))t.preventDefault(),I();else if(t.code==="ArrowLeft"&&e(E).length>1){t.preventDefault();const s=e(E).pop();s!==void 0&&q.delete(s),a(P,e(E).length),G(e(E).at(-1),!1,"eng")}}}function $e(){if(e(_)>=0&&q.size>=e(_)||q.size===e(x).length)return-1;let t;do t=Math.floor(Math.random()*e(x).length);while(q.has(t));return t}async function G(t,s=!0,n="kor"){if(!(t<0||t>=e(x).length)){s&&Qe(P),a(p,t),q.add(t),s&&e(E).push(t),await Ye(),e(l).pause(),ke(l,e(l).src=`${n==="kor"?e(ce):e(pe)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(l).play(),a(y,!0)}catch{M=!0}}}function Ee(){e(l)&&ke(l,e(l).onended=()=>{if(a(y,!1),M){M=!1,I();return}e(_)>=0&&q.size>=e(_)||e(_)<0&&q.size===e(x).length||e(k)>=0&&Ie()})}function Ie(){e(k)<0||(e(w)&&clearInterval(j),a(w,!0),a(C,Math.ceil(e(k)/1e3)),j=setInterval(()=>{Ze(C,-1)<=0&&(clearInterval(j),a(w,!1),e(y)?M=!0:I())},1e3))}function I(){e(l).pause(),clearInterval(j),a(y,a(w,M=!1)),a(C,0);const t=$e();if(t===-1){a(N,!0);return}G(t,!0,e(f)===2?"eng":"kor")}const Se=(t,s)=>s===1?"_".repeat(t.length):s===2?t[0]+"_".repeat(t.length-1):t,Le=t=>e(c)===4?t:e(c)===3?t.split(" ").map((s,n)=>n%2?"_".repeat(s.length):s).join(" "):e(c)>0?t.split(" ").map(s=>Se(s,e(c))).join(" "):"";function z(){e(l).pause(),clearInterval(j),a(y,a(w,M=!1)),a(p,-1),a(P,a(C,0)),q.clear(),a(E,[]),a(N,!1)}function Ae(){e(y)||e(w)||e(N)?z():I()}function De(){z(),a(J,(e(J)+1)%me.length)}function Me(t=!1){z(),a(c,(e(c)+(t?-1:1)+5)%5)}function Ce(t=!1){z(),a(f,(e(f)+(t?-1:1)+3)%3)}function je(){z(),a(F,(e(F)+1)%ue.length)}const _e=t=>G(t,!1,"eng");function ze(t){const{id:s,backward:n=!1}=t.detail;switch(s){case"start":Ae();break;case"count":De();break;case"hint":Me(n);break;case"kor":Ce(n);break;case"gap":je();break}}i(()=>le(),()=>{a(Z,le().params.id)}),i(()=>e(Z),()=>{a(D,`${ct}/assets/sentence/${e(Z)}`)}),i(()=>e(D),()=>{a(pe,`${e(D)}/audio`)}),i(()=>e(D),()=>{a(ce,`${e(D)}/audiok`)}),i(()=>e(F),()=>{a(k,ue[e(F)])}),i(()=>e(J),()=>{a(_,me[e(J)])}),i(()=>e(f),()=>{a(ve,e(f)===1)}),i(()=>e(f),()=>{a(de,e(f)===2)}),i(()=>e(f),()=>{a(ee,e(f)===0?"가":e(f)===1?"한":"영")}),i(()=>e(l),()=>{e(l)&&Ee()}),i(()=>e(_),()=>{a(te,e(_)<0?"전체":`${e(_)}개`)}),i(()=>(e(y),e(w)),()=>{a(X,e(y)||e(w))}),i(()=>e(k),()=>{a(ae,e(k)<0?"∞":`${e(k)/1e3}s`)}),i(()=>e(c),()=>{a(re,`H${e(c)}`)}),i(()=>(e(X),e(te),e(re),e(c),e(ee),e(ae)),()=>{a(fe,[{id:"start",icon:e(X)?"⏹":"▶"},{id:"count",text:`출제:${e(te)}`},{id:"hint",text:e(re),active:e(c)>0},{id:"kor",text:e(ee)},{id:"gap",text:e(ae)}])}),Je(),Xe();var he=xt(),ne=ie(he),Ke=v(ne);{var Oe=t=>{var s=ht(),n=ie(s),H=v(n),K=v(H,!0);d(H);var Q=b(H,2);{var S=o=>{var $=dt(),L=v($,!0);d($),R(()=>A(L,e(C))),m(o,$)};B(Q,o=>{e(k)>=0&&e(C)>0&&o(S)})}var Y=b(Q,2);{var T=o=>{var $=_t(),L=ie($);{var Ne=u=>{var h=ft(),U=v(h,!0);d(h),R(()=>A(U,e(se)[e(p)])),m(u,h)};B(L,u=>{e(ve)&&u(Ne)})}var Ge=b(L,2);{var He=u=>{var h=ut(),U=v(h,!0);d(h),R(()=>A(U,e(x)[e(p)])),m(u,h)},Te=(u,h)=>{{var U=O=>{var W=mt(),We=v(W,!0);d(W),R(Ve=>A(We,Ve),[()=>Le(e(x)[e(p)])],et),m(O,W)},Ue=O=>{var W=gt();m(O,W)};B(u,O=>{e(c)>0?O(U):O(Ue,!1)},h)}};B(Ge,u=>{e(de)?u(He):u(Te,!1)})}m(o,$)};B(Y,o=>{e(p)!==-1&&o(T)})}d(n);var oe=b(n,2);R(()=>{rt(n,1,`sentence-box ${e(X)?"playing":""}`,"svelte-164rmpq"),A(K,e(p)===-1?"Ready":`#${e(P)}`)}),V("click",n,function(...o){(e(p)===-1?I:()=>G(e(p),!1,"eng"))?.apply(this,o)}),V("keydown",n,o=>["Enter"," "].includes(o.key)&&(o.preventDefault(),e(p)===-1?I():G(e(p),!1,"eng"))),V("click",oe,I),m(t,s)},Re=t=>{var s=kt(),n=b(v(s),2);tt(n,1,()=>e(E),at,(H,K,Q)=>{var S=bt(),Y=v(S);Y.textContent=`${Q+1}.`;var T=b(Y,2),oe=v(T,!0);d(T);var o=b(T,2),$=v(o,!0);d(o),d(S),R(()=>{A(oe,e(x)[e(K)]),A($,e(se)[e(K)])}),V("click",S,()=>_e(e(K))),V("keydown",S,L=>["Enter"," "].includes(L.key)&&(L.preventDefault(),_e(e(K)))),m(H,S)}),d(s),m(t,s)};B(Ke,t=>{e(N)?t(Re,!1):t(Oe)})}d(ne);var be=b(ne,2);vt(be,{get buttons(){return e(fe)},$$events:{click:ze}});var Be=b(be,2);st(Be,t=>a(l,t),()=>e(l)),m(xe,he),Pe(),qe()}export{jt as component};
