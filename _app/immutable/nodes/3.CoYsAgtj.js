import{t as _,a as c,s as w,c as Jt,e as Kt,b as Qt}from"../chunks/DTjkHpgP.js";import"../chunks/DGCDY87e.js";import{a6 as Xt,a7 as S,a8 as Yt,f as T,a9 as Zt,g as t,a as s,e as r,c as f,r as n,s as h,aa as X,t as M,m as Y}from"../chunks/C1n7QiUv.js";import{i as E}from"../chunks/DxuJ5YGS.js";import{e as wt,i as Mt}from"../chunks/CKqkeeWi.js";import{s as te}from"../chunks/35GQtHY4.js";import{s as ee}from"../chunks/B81ulZpZ.js";import{b as ae}from"../chunks/DAIErdJE.js";import{i as re}from"../chunks/CRfTq02u.js";import{s as se,a as oe}from"../chunks/BcbruM5h.js";import{o as ne}from"../chunks/Dk0LuR_j.js";import{b as ie}from"../chunks/BA7HluVP.js";import{p as le}from"../chunks/BJ57T1Yb.js";import{C as ce}from"../chunks/B1AnoRyH.js";var ve=_('<div class="timer"> </div>'),de=_("<span></span> ",1),fe=_('<span class="revealed correct-word"> </span> ',1),me=_('<span class="revealed wrong-word"> </span> ',1),pe=_('<p class="kor"> </p> <p class="eng"></p>',1),ue=_('<button class="choice-btn"> </button>'),he=_('<div class="choices"></div>'),_e=_('<div class="sentence-box"><div class="order-big"> </div> <!> <!></div> <!>',1),ge=_('<div class="result-list"><h2> </h2> <h2> </h2></div>'),xe=_('<main class="wrapper"><!></main> <!> <audio playsinline="" preload="auto"></audio>',1);function Ae(kt,$t){Xt($t,!1);const[St,yt]=se(),vt=()=>oe(le,"$page",St),Z=s(),D=s(),Bt=s(),z=s(),g=s(),dt=s(),ft=s(),mt=s(),pt=[10,20,50,-1],ut=[10,30,-1],Ct=/[.,!?]/g;let L=s(0),W=s(0),P=[],ht=s([]),tt=[],i=s([]),x=s([]),_t=s(),m=s(-1),et=s(0),at=s(!1),y=s(0),U=s(0),B=s(0),j=s(0),q;const V=new Set,F=e=>e.replace(Ct,""),It=e=>{for(let a=e.length-1;a>0;a--){const o=Math.floor(Math.random()*(a+1));[e[a],e[o]]=[e[o],e[a]]}return e},Tt=()=>{if(t(z)>=0&&V.size>=t(z)||V.size===P.length)return-1;let e;do e=Math.floor(Math.random()*P.length);while(V.has(e));return e};ne(async()=>{const e=await fetch(`${t(D)}/sentences.json`);if(!e.ok)return;const a=await e.json();P=a.sentences,r(ht,a.korean),tt=[...new Set(P.flatMap(o=>o.split(" ").map(F)))]});function Et(){H(),!(t(g)<0)&&(r(j,t(g)),q=setInterval(()=>{X(j,-1),t(j)<=0&&(H(),rt())},1e3))}function H(){q&&clearInterval(q),q=void 0}function zt(e){const a=P[e].split(" "),o=new Set,p=Math.min(4,3+Math.floor(Math.random()*2));for(;o.size<Math.min(p,a.length);)o.add(Math.floor(Math.random()*a.length));r(x,[...o].map(l=>{const v=F(a[l]),b=new Set([v]);for(;b.size<10;)b.add(tt[Math.floor(Math.random()*tt.length)]);return{index:l,choices:It([...b])}}).sort((l,v)=>l.index-v.index)),r(i,a.map((l,v)=>{const b=o.has(v);return{text:l,isBlank:b,active:b&&v===t(x)[0].index,len:b?Math.max(F(l).length,3):0,result:void 0}})),r(y,0),Et()}function rt(){const e=Tt();if(e===-1){r(at,!0),H();return}r(m,e),X(et),V.add(e),zt(e),r(B,t(B)+t(x).length)}function jt(e){const{index:a}=t(x)[t(y)],o=F(t(i)[a].text),p=e===o;p&&X(U),Y(i,t(i)[a].isBlank=!1),Y(i,t(i)[a].active=!1),Y(i,t(i)[a].result=p?"correct":"wrong"),X(y),t(y)<t(x).length?Y(i,t(i)[t(x)[t(y)].index].active=!0):rt()}function st(){H(),r(m,-1),r(et,0),r(U,0),r(B,0),r(at,!1),V.clear(),r(i,[]),r(x,[]),r(j,0)}function At(e){const{id:a}=e.detail;a==="start"&&(t(m)===-1?rt():st()),a==="count"&&(r(L,(t(L)+1)%pt.length),st()),a==="time"&&(r(W,(t(W)+1)%ut.length),st())}S(()=>vt(),()=>{r(Z,vt().params.id)}),S(()=>t(Z),()=>{r(D,`${ie}/assets/sentence/${t(Z)}`)}),S(()=>t(D),()=>{r(Bt,`${t(D)}/audio`)}),S(()=>t(L),()=>{r(z,pt[t(L)])}),S(()=>t(W),()=>{r(g,ut[t(W)])}),S(()=>(t(B),t(U)),()=>{r(dt,t(B)?Math.round(t(U)/t(B)*100):0)}),S(()=>(t(g),t(j)),()=>{r(ft,t(g)<0?"∞":`${t(j)}s`)}),S(()=>(t(m),t(z),t(g)),()=>{r(mt,[{id:"start",icon:t(m)===-1?"▶":"⏹"},{id:"count",text:t(z)<0?"전체":`${t(z)}개`},{id:"time",text:t(g)<0?"∞":`${t(g)}s`}])}),Yt(),re();var gt=xe(),ot=T(gt),Nt=f(ot);{var Pt=e=>{var a=_e(),o=T(a),p=f(o),l=f(p,!0);n(p);var v=h(p,2);{var b=d=>{var u=ve(),C=f(u);n(u),M(()=>w(C,`⏱ ${t(ft)??""}`)),c(d,u)};E(v,d=>{t(g)>=0&&t(m)!==-1&&d(b)})}var Gt=h(v,2);{var Ot=d=>{var u=pe(),C=T(u),J=f(C,!0);n(C);var I=h(C,2);wt(I,5,()=>t(i),Mt,(nt,k)=>{var bt=Jt(),Lt=T(bt);{var Wt=A=>{var K=de(),G=T(K),it=h(G,1,!0);it.nodeValue=" ",M(()=>{te(G,1,`blank ${t(k).active?"highlight":""}`),ee(G,`width:${t(k).len??""}ch;`)}),c(A,K)},qt=(A,K)=>{{var G=N=>{var Q=fe(),O=T(Q),lt=f(O,!0);n(O);var $=h(O,1,!0);$.nodeValue=" ",M(()=>w(lt,t(k).text)),c(N,Q)},it=(N,Q)=>{{var O=$=>{var R=me(),ct=T(R),Ft=f(ct,!0);n(ct);var Ht=h(ct,1,!0);Ht.nodeValue=" ",M(()=>w(Ft,t(k).text)),c($,R)},lt=$=>{var R=Qt();M(()=>w(R,`${t(k).text??""} `)),c($,R)};E(N,$=>{t(k).result==="wrong"?$(O):$(lt,!1)},Q)}};E(A,N=>{t(k).result==="correct"?N(G):N(it,!1)},K)}};E(Lt,A=>{t(k).isBlank?A(Wt):A(qt,!1)})}c(nt,bt)}),n(I),M(()=>w(J,t(ht)[t(m)])),c(d,u)};E(Gt,d=>{t(m)!==-1&&d(Ot)})}n(o);var Rt=h(o,2);{var Dt=d=>{var u=he();wt(u,5,()=>t(x)[t(y)].choices,Mt,(C,J)=>{var I=ue(),nt=f(I,!0);n(I),M(()=>w(nt,t(J))),Kt("click",I,()=>jt(t(J))),c(C,I)}),n(u),c(d,u)};E(Rt,d=>{t(m)!==-1&&t(y)<t(x).length&&d(Dt)})}M(()=>w(l,t(m)===-1?"Ready":`#${t(et)}`)),c(e,a)},Ut=e=>{var a=ge(),o=f(a),p=f(o);n(o);var l=h(o,2),v=f(l);n(l),n(a),M(()=>{w(p,`정답 : ${t(U)??""} / ${t(B)??""}`),w(v,`점수 : ${t(dt)??""}점`)}),c(e,a)};E(Nt,e=>{t(at)?e(Ut,!1):e(Pt)})}n(ot);var xt=h(ot,2);ce(xt,{get buttons(){return t(mt)},$$events:{click:At}});var Vt=h(xt,2);ae(Vt,e=>r(_t,e),()=>t(_t)),c(kt,gt),Zt(),yt()}export{Ae as component};
