import"../chunks/NZTpNUN0.js";import{i as Ve}from"../chunks/C1kFBjD0.js";import{p as Ye,a3 as l,a4 as Ze,t as g,f as de,a as f,b as et,g as e,d as s,s as x,o as a,a5 as tt,a8 as at,m as qe,e as p,r as d,a9 as st,h as B,i as L,a6 as F,c as nt,K as rt}from"../chunks/kc4YAh9y.js";import{i as H}from"../chunks/meG6WkfV.js";import{e as lt,i as ot}from"../chunks/BvPctM3R.js";import{s as it}from"../chunks/D8RCsmFZ.js";import{b as ct}from"../chunks/eT6sziqz.js";import{s as vt,a as pt}from"../chunks/CxXm-2W8.js";import{o as dt,a as ft}from"../chunks/B6AwUu_V.js";import{p as ut}from"../chunks/M8CTRV_v.js";import{b as gt}from"../chunks/CBOUq7KX.js";import{C as _t}from"../chunks/Dw7rxz5s.js";var mt=g('<div class="remain-big svelte-vlwcqt"> </div>'),ht=g('<p class="placeholder svelte-vlwcqt">•••</p>'),bt=g('<p class="kor svelte-vlwcqt"> </p>'),kt=g('<p class="eng svelte-vlwcqt"> </p>'),wt=g('<p class="eng svelte-vlwcqt"> </p>'),xt=g('<div role="button" tabindex="0"><div class="order-big svelte-vlwcqt"> </div> <!> <!></div> <button class="next-btn svelte-vlwcqt">NEXT ⏭</button>',1),yt=g('<div class="result-item svelte-vlwcqt" role="button" tabindex="0"><span class="num svelte-vlwcqt"></span> <span class="eng txt svelte-vlwcqt"> </span> <span class="kor txt svelte-vlwcqt"> </span></div>'),qt=g('<div class="result-list svelte-vlwcqt"><h2 class="svelte-vlwcqt">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),$t=g('<main class="wrapper svelte-vlwcqt"><!></main> <!> <audio playsinline="" preload="auto" class="svelte-vlwcqt"></audio>',1);function Rt($e,Se){Ye(Se,!1);const[Ie,Le]=vt(),fe=()=>pt(ut,"$page",Ie),ee=s(),E=s(),ue=s(),ge=s(),_=s(),u=s(),_e=s(),te=s(),J=s(),ae=s(),se=s(),ne=s(),re=s(),me=s(),he=[1e4,2e4,3e4,-1],be=[10,20,50,-1];let P=s(0),Q=s(0),m=s([]),le=s([]),c=s(-1),V=s(0),o=s(),h=s(!1),b=s(!1),A=!1,D=s(0),C,N=s(!1),y=s(!0),G=s(!1),v=s(0);const k=new Set;let q=s([]);dt(()=>(fetch(`${e(E)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a(m,t.sentences),a(le,t.korean))}),window.addEventListener("keydown",ke),()=>window.removeEventListener("keydown",ke))),ft(()=>{e(o)?.pause(),clearInterval(C)});function ke(t){if(!e(N)){if(["Space","ArrowRight"].includes(t.code))t.preventDefault(),$();else if(t.code==="ArrowLeft"&&e(q).length>1){t.preventDefault();const n=e(q).pop();n!==void 0&&k.delete(n),a(V,e(q).length),T(e(q).at(-1),!1)}}}function Ee(){if(e(u)>=0&&k.size>=e(u)||k.size===e(m).length)return-1;let t;do t=Math.floor(Math.random()*e(m).length);while(k.has(t));return t}async function T(t,n=!0){if(!(t<0||t>=e(m).length)){n&&tt(V),a(c,t),k.add(t),n&&e(q).push(t),await at(),e(o).pause(),qe(o,e(o).src=`${e(_e)==="kor"?e(ge):e(ue)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(o).play(),a(h,!0)}catch{A=!0}}}function Ae(){e(o)&&qe(o,e(o).onended=()=>{if(a(h,!1),A){A=!1,$();return}e(u)>=0&&k.size>=e(u)||e(u)<0&&k.size===e(m).length||e(_)>=0&&De()})}function De(){e(_)<0||(e(b)&&clearInterval(C),a(b,!0),a(D,Math.ceil(e(_)/1e3)),C=setInterval(()=>{st(D,-1)<=0&&(clearInterval(C),a(b,!1),e(h)?A=!0:$())},1e3))}function $(){e(o).pause(),clearInterval(C),a(h,a(b,A=!1)),a(D,0);const t=Ee();if(t===-1){a(N,!0);return}T(t,!0)}const Ce=(t,n)=>n===1?"_".repeat(t.length):n===2?t[0]+"_".repeat(t.length-1):t,je=t=>e(v)===4?t:e(v)===3?t.split(" ").map((n,i)=>i%2?"_".repeat(n.length):n).join(" "):e(v)>0?t.split(" ").map(n=>Ce(n,e(v))).join(" "):"";function j(){e(o).pause(),clearInterval(C),a(h,a(b,A=!1)),a(c,-1),a(V,a(D,0)),k.clear(),a(q,[]),a(N,!1)}function ze(){e(h)||e(b)||e(N)?j():$()}function Ke(){j(),a(Q,(e(Q)+1)%be.length)}function Me(t=!1){j(),a(v,(e(v)+(t?-1:1)+5)%5)}function Oe(){j(),a(y,!e(y))}function Re(){a(G,!e(G))}function Be(){j(),a(P,(e(P)+1)%he.length)}const we=t=>T(t,!1);function He(t){const{id:n,backward:i=!1}=t.detail;switch(n){case"start":ze();break;case"count":Ke();break;case"hint":Me(i);break;case"lang":Oe();break;case"hide":Re();break;case"gap":Be();break}}l(()=>fe(),()=>{a(ee,fe().params.id)}),l(()=>e(ee),()=>{a(E,`${gt}/assets/sentence/${e(ee)}`)}),l(()=>e(E),()=>{a(ue,`${e(E)}/audio`)}),l(()=>e(E),()=>{a(ge,`${e(E)}/audiok`)}),l(()=>e(P),()=>{a(_,he[e(P)])}),l(()=>e(Q),()=>{a(u,be[e(Q)])}),l(()=>e(y),()=>{a(_e,e(y)?"kor":"eng")}),l(()=>e(o),()=>{e(o)&&Ae()}),l(()=>e(u),()=>{a(te,e(u)<0?"전체":`${e(u)}개`)}),l(()=>(e(h),e(b)),()=>{a(J,e(h)||e(b))}),l(()=>e(_),()=>{a(ae,e(_)<0?"∞":`${e(_)/1e3}s`)}),l(()=>e(v),()=>{a(se,`H${e(v)}`)}),l(()=>e(y),()=>{a(ne,e(y)?"한":"영")}),l(()=>e(G),()=>{a(re,e(G)?"보기":"가리기")}),l(()=>(e(J),e(te),e(se),e(v),e(ne),e(re),e(ae)),()=>{a(me,[{id:"start",icon:e(J)?"⏹":"▶"},{id:"count",text:`출제:${e(te)}`},{id:"hint",text:e(se),active:e(v)>0},{id:"lang",text:e(ne)},{id:"hide",text:e(re)},{id:"gap",text:e(ae)}])}),Ze(),Ve();var xe=$t(),oe=de(xe),Ne=p(oe);{var Ge=t=>{var n=xt(),i=de(n),U=p(i),z=p(U,!0);d(U);var Y=x(U,2);{var S=r=>{var w=mt(),K=p(w,!0);d(w),B(()=>L(K,e(D))),f(r,w)};H(Y,r=>{e(_)>=0&&e(D)>0&&r(S)})}var Z=x(Y,2);{var W=r=>{var w=nt(),K=de(w);{var We=M=>{var ce=ht();f(M,ce)},Xe=(M,ce)=>{{var Fe=O=>{var X=bt(),ve=p(X,!0);d(X),B(()=>L(ve,e(le)[e(c)])),f(O,X)},Je=(O,X)=>{{var ve=R=>{var I=kt(),pe=p(I,!0);d(I),B(Qe=>L(pe,Qe),[()=>je(e(m)[e(c)])],rt),f(R,I)},Pe=R=>{var I=wt(),pe=p(I,!0);d(I),B(()=>L(pe,e(m)[e(c)])),f(R,I)};H(O,R=>{e(v)>0?R(ve):R(Pe,!1)},X)}};H(M,O=>{e(y)?O(Fe):O(Je,!1)},ce)}};H(K,M=>{e(G)?M(We):M(Xe,!1)})}f(r,w)};H(Z,r=>{e(c)!==-1&&r(W)})}d(i);var ie=x(i,2);B(()=>{it(i,1,`sentence-box ${e(J)?"playing":""}`,"svelte-vlwcqt"),L(z,e(c)===-1?"Ready":`#${e(V)}`)}),F("click",i,function(...r){(e(c)===-1?$:()=>T(e(c),!1))?.apply(this,r)}),F("keydown",i,r=>["Enter"," "].includes(r.key)&&(r.preventDefault(),e(c)===-1?$():T(e(c),!1))),F("click",ie,$),f(t,n)},Te=t=>{var n=qt(),i=x(p(n),2);lt(i,1,()=>e(q),ot,(U,z,Y)=>{var S=yt(),Z=p(S);Z.textContent=`${Y+1}.`;var W=x(Z,2),ie=p(W,!0);d(W);var r=x(W,2),w=p(r,!0);d(r),d(S),B(()=>{L(ie,e(m)[e(z)]),L(w,e(le)[e(z)])}),F("click",S,()=>we(e(z))),F("keydown",S,K=>["Enter"," "].includes(K.key)&&(K.preventDefault(),we(e(z)))),f(U,S)}),d(n),f(t,n)};H(Ne,t=>{e(N)?t(Te,!1):t(Ge)})}d(oe);var ye=x(oe,2);_t(ye,{get buttons(){return e(me)},$$events:{click:He}});var Ue=x(ye,2);ct(Ue,t=>a(o,t),()=>e(o)),f($e,xe),et(),Le()}export{Rt as component};
