import"../chunks/NZTpNUN0.js";import"../chunks/DUMHf_my.js";import{p as Kt,ag as S,ah as Qt,t as _,f as C,a as c,b as Wt,g as t,d as s,q as r,e as f,r as n,s as u,ai as X,h as k,c as Xt,m as Y,aj as Yt}from"../chunks/bplG7q_8.js";import{s as w,e as Zt}from"../chunks/CyL3djLh.js";import{i as E}from"../chunks/Cf2Bun1O.js";import{e as kt,i as wt}from"../chunks/CPKHhc1S.js";import{s as te}from"../chunks/DzyRjOIa.js";import{s as ee}from"../chunks/N0OzDCDk.js";import{b as ae}from"../chunks/CgFHA2ll.js";import{i as re}from"../chunks/BaxgYlCQ.js";import{s as se,a as oe}from"../chunks/CH-E4zoY.js";import{o as ne}from"../chunks/C6rqwIBa.js";import{b as ie}from"../chunks/CFebDksM.js";import{p as le}from"../chunks/D-XRLTki.js";import{C as ce}from"../chunks/BtjfU33a.js";var ve=_('<div class="timer svelte-1daikbg"> </div>'),de=_("<span></span> ",1),fe=_('<span class="revealed correct-word svelte-1daikbg"> </span> ',1),me=_('<span class="revealed wrong-word svelte-1daikbg"> </span> ',1),pe=_('<p class="kor svelte-1daikbg"> </p> <p class="eng svelte-1daikbg"></p>',1),he=_('<button class="choice-btn svelte-1daikbg"> </button>'),ue=_('<div class="choices svelte-1daikbg"></div>'),_e=_('<div class="sentence-box svelte-1daikbg"><div class="order-big svelte-1daikbg"> </div> <!> <!></div> <!>',1),ge=_('<div class="result-list svelte-1daikbg"><h2 class="svelte-1daikbg"> </h2> <h2 class="svelte-1daikbg"> </h2></div>'),be=_('<main class="wrapper svelte-1daikbg"><!></main> <!> <audio playsinline="" preload="auto" class="svelte-1daikbg"></audio>',1);function Ne(Mt,$t){Kt($t,!1);const[St,yt]=se(),vt=()=>oe(le,"$page",St),Z=s(),q=s(),Bt=s(),j=s(),g=s(),dt=s(),ft=s(),mt=s(),pt=[10,20,50,-1],ht=[10,30,-1],It=/[.,!?]/g;let D=s(0),L=s(0),P=[],ut=s([]),tt=[],i=s([]),b=s([]),_t=s(),m=s(-1),et=s(0),at=s(!1),y=s(0),U=s(0),B=s(0),z=s(0),F;const V=new Set,H=e=>e.replace(It,""),Tt=e=>{for(let a=e.length-1;a>0;a--){const o=Math.floor(Math.random()*(a+1));[e[a],e[o]]=[e[o],e[a]]}return e},Ct=()=>{if(t(j)>=0&&V.size>=t(j)||V.size===P.length)return-1;let e;do e=Math.floor(Math.random()*P.length);while(V.has(e));return e};ne(async()=>{const e=await fetch(`${t(q)}/sentences.json`);if(!e.ok)return;const a=await e.json();P=a.sentences,r(ut,a.korean),tt=[...new Set(P.flatMap(o=>o.split(" ").map(H)))]});function Et(){J(),!(t(g)<0)&&(r(z,t(g)),F=setInterval(()=>{X(z,-1),t(z)<=0&&(J(),rt())},1e3))}function J(){F&&clearInterval(F),F=void 0}function jt(e){const a=P[e].split(" "),o=new Set,p=Math.min(4,3+Math.floor(Math.random()*2));for(;o.size<Math.min(p,a.length);)o.add(Math.floor(Math.random()*a.length));r(b,[...o].map(l=>{const v=H(a[l]),x=new Set([v]);for(;x.size<10;)x.add(tt[Math.floor(Math.random()*tt.length)]);return{index:l,choices:Tt([...x])}}).sort((l,v)=>l.index-v.index)),r(i,a.map((l,v)=>{const x=o.has(v);return{text:l,isBlank:x,active:x&&v===t(b)[0].index,len:x?Math.max(H(l).length,3):0,result:void 0}})),r(y,0),Et()}function rt(){const e=Ct();if(e===-1){r(at,!0),J();return}r(m,e),X(et),V.add(e),jt(e),r(B,t(B)+t(b).length)}function zt(e){const{index:a}=t(b)[t(y)],o=H(t(i)[a].text),p=e===o;p&&X(U),Y(i,t(i)[a].isBlank=!1),Y(i,t(i)[a].active=!1),Y(i,t(i)[a].result=p?"correct":"wrong"),X(y),t(y)<t(b).length?Y(i,t(i)[t(b)[t(y)].index].active=!0):rt()}function st(){J(),r(m,-1),r(et,r(U,r(B,r(z,0)))),r(at,!1),V.clear(),r(i,[]),r(b,[])}function At(e){const{id:a}=e.detail;a==="start"&&(t(m)===-1?rt():st()),a==="count"&&(r(D,(t(D)+1)%pt.length),st()),a==="time"&&(r(L,(t(L)+1)%ht.length),st())}S(()=>vt(),()=>{r(Z,vt().params.id)}),S(()=>t(Z),()=>{r(q,`${ie}/assets/sentence/${t(Z)}`)}),S(()=>t(q),()=>{r(Bt,`${t(q)}/audio`)}),S(()=>t(D),()=>{r(j,pt[t(D)])}),S(()=>t(L),()=>{r(g,ht[t(L)])}),S(()=>(t(B),t(U)),()=>{r(dt,t(B)?Math.round(t(U)/t(B)*100):0)}),S(()=>(t(g),t(z)),()=>{r(ft,t(g)<0?"∞":`${t(z)}s`)}),S(()=>(t(m),t(j),t(g)),()=>{r(mt,[{id:"start",icon:t(m)===-1?"▶":"⏹"},{id:"count",text:t(j)<0?"전체":`${t(j)}개`},{id:"time",text:t(g)<0?"∞":`${t(g)}s`}])}),Qt(),re();var gt=be(),ot=C(gt),Nt=f(ot);{var Pt=e=>{var a=_e(),o=C(a),p=f(o),l=f(p,!0);n(p);var v=u(p,2);{var x=d=>{var h=ve(),I=f(h);n(h),k(()=>w(I,`⏱ ${t(ft)??""}`)),c(d,h)};E(v,d=>{t(g)>=0&&t(m)!==-1&&d(x)})}var Gt=u(v,2);{var Ot=d=>{var h=pe(),I=C(h),K=f(I,!0);n(I);var T=u(I,2);kt(T,5,()=>t(i),wt,(nt,M)=>{var xt=Xt(),Dt=C(xt);{var Lt=A=>{var Q=de(),G=C(Q),it=u(G,1,!0);it.nodeValue=" ",k(()=>{te(G,1,`blank ${t(M).active?"highlight":""}`,"svelte-1daikbg"),ee(G,`width:${t(M).len??""}ch;`)}),c(A,Q)},Ft=(A,Q)=>{{var G=N=>{var W=fe(),O=C(W),lt=f(O,!0);n(O);var $=u(O,1,!0);$.nodeValue=" ",k(()=>w(lt,t(M).text)),c(N,W)},it=(N,W)=>{{var O=$=>{var R=me(),ct=C(R),Ht=f(ct,!0);n(ct);var Jt=u(ct,1,!0);Jt.nodeValue=" ",k(()=>w(Ht,t(M).text)),c($,R)},lt=$=>{var R=Yt();k(()=>w(R,`${t(M).text??""} `)),c($,R)};E(N,$=>{t(M).result==="wrong"?$(O):$(lt,!1)},W)}};E(A,N=>{t(M).result==="correct"?N(G):N(it,!1)},Q)}};E(Dt,A=>{t(M).isBlank?A(Lt):A(Ft,!1)})}c(nt,xt)}),n(T),k(()=>w(K,t(ut)[t(m)])),c(d,h)};E(Gt,d=>{t(m)!==-1&&d(Ot)})}n(o);var Rt=u(o,2);{var qt=d=>{var h=ue();kt(h,5,()=>t(b)[t(y)].choices,wt,(I,K)=>{var T=he(),nt=f(T,!0);n(T),k(()=>w(nt,t(K))),Zt("click",T,()=>zt(t(K))),c(I,T)}),n(h),c(d,h)};E(Rt,d=>{t(m)!==-1&&t(y)<t(b).length&&d(qt)})}k(()=>w(l,t(m)===-1?"Ready":`#${t(et)}`)),c(e,a)},Ut=e=>{var a=ge(),o=f(a),p=f(o);n(o);var l=u(o,2),v=f(l);n(l),n(a),k(()=>{w(p,`정답 : ${t(U)??""} / ${t(B)??""}`),w(v,`점수 : ${t(dt)??""}점`)}),c(e,a)};E(Nt,e=>{t(at)?e(Ut,!1):e(Pt)})}n(ot);var bt=u(ot,2);ce(bt,{get buttons(){return t(mt)},$$events:{click:At}});var Vt=u(bt,2);ae(Vt,e=>r(_t,e),()=>t(_t)),c(Mt,gt),Wt(),yt()}export{Ne as component};
