import{t as D,e as f,a as P,s as m}from"../chunks/C84cx4to.js";import"../chunks/Cz3YCu0P.js";import{h as W,a9 as fe,aa as X,ab as me,f as _e,t as T,ac as he,s as c,c as o,g as e,a as n,l as s,r as a,ae as ge,m as Y}from"../chunks/CWJw-b4-.js";import{i as Z}from"../chunks/KPcsEuus.js";import{e as ke,i as be}from"../chunks/DLP_h01C.js";import{s as ee}from"../chunks/DmHdXTYY.js";import{t as ye,s as $e}from"../chunks/DMbZqknN.js";import{b as xe}from"../chunks/CV8ZBm2l.js";import{i as we}from"../chunks/VsyBG53z.js";import{s as Se,a as Ee}from"../chunks/V4_yusMK.js";import{o as Oe,a as Ae}from"../chunks/xR0fCDvz.js";import{p as Fe}from"../chunks/NY1RqqaB.js";import{b as ze}from"../chunks/BQnrKkCd.js";function te(_,w,C,K){var S=_.__style;if(W||S!==w){var p=ye(w);(!W||p!==_.getAttribute("style"))&&(p==null?_.removeAttribute("style"):_.style.cssText=p),_.__style=w}return K}var Ie=D('<div class="photo svelte-1usks4h"><div class="label svelte-1usks4h"> </div> <img class="svelte-1usks4h"></div>'),je=D('<div class="kor svelte-1usks4h"> </div>'),Be=D('<div><div class="speaker svelte-1usks4h"> </div> <div class="text"> </div> <!></div>'),Me=D('<div class="wrap svelte-1usks4h"><div class="main svelte-1usks4h"><!> <div class="dialogue svelte-1usks4h"></div></div> <div class="ctl svelte-1usks4h"><button class="svelte-1usks4h"> </button> <button class="svelte-1usks4h"> </button> <button class="svelte-1usks4h"> </button> <button class="svelte-1usks4h">크기</button> <button class="svelte-1usks4h"> </button></div></div> <audio playsinline="" preload="auto" style="display:none"></audio>',1);function Qe(_,w){fe(w,!1);const[C,K]=Se(),S=()=>Ee(Fe,"$page",C),p=n(),b=n();let d=n([]),E=n({}),v=n(-1),h=n(!1),g=n("none"),O=n("1.2em"),A=n(!0),F=n(!0),u=n();Oe(async()=>{if(!e(p))return;const t=await fetch(`${e(b)}/dialogue.json`);if(!t.ok)return;const i=await t.json();s(E,i.persons),s(d,i.conversation.map((l,r)=>({...l,file:`${e(b)}/audio/${String(r+1).padStart(2,"0")}.mp3`})))}),Ae(()=>{var t;return(t=e(u))==null?void 0:t.pause()});async function y(t,i=!0){var l,r;if(t<0||t>=e(d).length){s(h,!1);return}s(v,t),await ge(),(l=document.getElementById(`segment-${t}`))==null||l.scrollIntoView({behavior:"smooth",block:"center"}),e(u).pause(),Y(u,e(u).src=e(d)[t].file),Y(u,e(u).muted=!!((r=e(E)[e(d)[t].speaker])!=null&&r.hideEnglish));try{await e(u).play()}catch{s(h,!1);return}s(h,!0)}function se(){e(g)==="segment"?y(e(v),!1):e(v)<e(d).length-1?y(e(v)+1):e(g)==="all"?y(0):s(h,!1)}function ae(){e(h)?(e(u).pause(),s(h,!1)):e(v)===-1?y(0):y(e(v),!1)}function re(){s(g,e(g)==="none"?"all":e(g)==="all"?"segment":"none")}function oe(t){t.target.src=`${e(b)}/ready.webp`}X(()=>S(),()=>{var t;s(p,((t=S().url.pathname.match(/\/dialogue\/([^\/]+)/))==null?void 0:t[1])||"")}),X(()=>e(p),()=>{s(b,`${ze}/assets/dialogue/${e(p)}`)}),me(),we();var G=Me(),R=_e(G),V=o(R),H=o(V);{var le=t=>{var i=Ie(),l=o(i),r=o(l,!0);a(l);var $=c(l,2);a(i),T(()=>{var B,k,M;m(r,((k=e(E)[(B=e(d)[e(v)])==null?void 0:B.speaker])==null?void 0:k.name)||""),ee($,"src",(M=e(d)[e(v)])!=null&&M.speaker?`${e(b)}/${e(d)[e(v)].speaker}.webp`:`${e(b)}/ready.webp`)}),f("error",$,oe),P(t,i)};Z(H,t=>{e(F)&&t(le)})}var J=c(H,2);ke(J,5,()=>e(d),be,(t,i,l)=>{var r=Be();ee(r,"id",`segment-${l}`);var $=o(r),B=o($);a($);var k=c($,2),M=o(k,!0);a(k);var ce=c(k,2);{var de=x=>{var N=je(),pe=o(N,!0);a(N),T(()=>{te(N,`font-size:${e(O)??""}`),m(pe,e(i).korean)}),P(x,N)};Z(ce,x=>{e(A)&&x(de)})}a(r),T(()=>{var x;$e(r,1,`seg ${l===e(v)?"active":""}`,"svelte-1usks4h"),m(B,`${((x=e(E)[e(i).speaker])==null?void 0:x.name)??""}:`),te(k,`font-size:${e(O)??""}`),m(M,e(i).text)}),f("click",r,()=>y(l)),P(t,r)}),a(J),a(V);var L=c(V,2),z=o(L),ie=o(z,!0);a(z);var I=c(z,2),ne=o(I);a(I);var j=c(I,2),ve=o(j,!0);a(j);var Q=c(j,2),q=c(Q,2),ue=o(q,!0);a(q),a(L),a(R);var U=c(R,2);xe(U,t=>s(u,t),()=>e(u)),T(()=>{m(ie,e(h)?"⏸":"▶"),m(ne,`반복:${e(g)==="none"?"없음":e(g)==="all"?"전체":"구간"}`),m(ve,e(A)?"한글 ON":"한글 OFF"),m(ue,e(F)?"사진 ON":"사진 OFF")}),f("click",z,ae),f("click",I,re),f("click",j,()=>s(A,!e(A))),f("click",Q,()=>s(O,e(O)==="1.2em"?"2em":"1.2em")),f("click",q,()=>s(F,!e(F))),f("ended",U,se),P(_,G),he(),K()}export{Qe as component};
