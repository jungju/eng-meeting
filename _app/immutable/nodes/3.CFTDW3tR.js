import{t as R,e as b,a as T,s as f}from"../chunks/D2y0niO5.js";import"../chunks/D4TFS71g.js";import{h as Q,a3 as pt,a7 as ft,a8 as vt,t as q,a5 as ct,a6 as v,c as r,g as t,o as c,q as n,a9 as ut,r as o,aa as mt}from"../chunks/BXl0y74R.js";import{i as U}from"../chunks/DM47GmrI.js";import{e as gt,i as ht}from"../chunks/B4N4kkHG.js";import{s as W}from"../chunks/BVs_O_Ia.js";import{t as xt}from"../chunks/BQs9fFl7.js";import{i as bt}from"../chunks/CDOc-NWU.js";import{s as _t,a as yt}from"../chunks/D_3_62pX.js";import{o as $t}from"../chunks/D_9bqR7V.js";import{p as wt}from"../chunks/DZ7uNZkj.js";function K(g,$,H,V){var A=g.__style;if(Q||A!==$){var l=xt($);(!Q||l!==g.getAttribute("style"))&&(l==null?g.removeAttribute("style"):g.style.cssText=l),g.__style=$}return V}var kt=R('<div style="width:40%; background:#f0f0f0; display:flex; align-items:center; justify-content:center; position:relative;"><div style="position:absolute; top:10px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.3); color:#fff; padding:5px 10px; border-radius:5px; font-weight:bold;"> </div> <img style="max-width:90%; max-height:90%; border-radius:10px;"></div>'),zt=R("<div> </div>"),Et=R('<div><div style="color:#2a3d66; font-weight:bold; margin-bottom:5px; font-size:1.2em;"> </div> <div> </div> <!></div>'),St=R('<div style="position:absolute; top:50px; left:0; right:0; bottom:0; display:flex; flex-direction:column; overflow:hidden;"><div style="flex:1; display:flex; overflow:hidden;"><!> <div></div></div> <div style="background:#fff; padding:10px; border-top:1px solid #ccc; display:flex; justify-content:center; gap:8px;"><button style="width:110px; height:48px; font-size:0.7em;"> </button> <button style="width:110px; height:48px; font-size:0.7em;"> </button> <button style="width:110px; height:48px; font-size:0.7em;"> </button> <button style="width:110px; height:48px; font-size:0.7em;"> </button> <button style="width:110px; height:48px; font-size:0.7em;"> </button></div></div>');function Kt(g,$){pt($,!1);const[H,V]=_t(),A=()=>yt(wt,"$page",H),l=c(),w="/assets/dialogue";let u=c([]),d=c(-1),p=null,k=c(!1),h=c("none"),z=c("1.2em"),j=c(!0),E=c(!0),m=c({});$t(async()=>{if(!t(l))return;const e=await fetch(`${w}/${t(l)}/dialogue.json`);if(e.ok){const i=await e.json();n(m,i.persons),n(u,i.conversation.map((a,s)=>({...a,filePath:`${w}/${t(l)}/audio/${String(s+1).padStart(2,"0")}.mp3`})));for(const a in t(m))ut(m,t(m)[a].hideEnglish=!!t(m)[a].hideEnglish)}});async function S(e){var a,s;if(e<0||e>=t(u).length)return;p==null||p.pause(),n(d,e),await mt(),(a=document.getElementById(`segment-${e}`))==null||a.scrollIntoView({behavior:"smooth",block:"center"});const i=t(u)[e];p=new Audio(i.filePath),p.muted=(s=t(m)[i.speaker])==null?void 0:s.hideEnglish,p.onended=()=>{t(h)==="segment"?S(t(d)):t(d)<t(u).length-1?S(t(d)+1):t(h)==="all"?S(0):n(k,!1)},n(k,!0),p.play()}function Y(){p?p.paused?(p.play(),n(k,!0)):(p.pause(),n(k,!1)):S(t(d)>=0?t(d):0)}function Z(){n(h,t(h)==="none"?"all":t(h)==="all"?"segment":"none")}function tt(e){e.target.src=`${w}/${t(l)}/ready.webp`}ft(()=>A(),()=>{n(l,(()=>{const e=A().url.pathname.match(/\/dialogue\/([^\/]+)/);return e?e[1]:""})())}),vt(),bt();var X=St(),C=r(X),J=r(C);{var et=e=>{var i=kt(),a=r(i),s=r(a,!0);o(a);var _=v(a,2);o(i),q(()=>{var B,x,M;f(s,((x=t(m)[(B=t(u)[t(d)])==null?void 0:B.speaker])==null?void 0:x.name)||""),W(_,"src",(M=t(u)[t(d)])!=null&&M.speaker?`${w}/${t(l)}/${t(u)[t(d)].speaker}.webp`:`${w}/${t(l)}/ready.webp`)}),b("error",_,tt),T(e,i)};U(J,e=>{t(E)&&e(et)})}var D=v(J,2);gt(D,5,()=>t(u),ht,(e,i,a)=>{var s=Et();W(s,"id",`segment-${a}`);var _=r(s),B=r(_);o(_);var x=v(_,2),M=r(x,!0);o(x);var nt=v(x,2);{var lt=y=>{var N=zt(),dt=r(N,!0);o(N),q(()=>{K(N,`font-size:${t(z)??""}; color:#555;`),f(dt,t(i).korean)}),T(y,N)};U(nt,y=>{t(j)&&y(lt)})}o(s),q(()=>{var y;K(s,`margin-bottom:15px; padding:10px; cursor:pointer; border-bottom:1px solid #ddd; background:${a===t(d)?"#d0f0d0":"transparent"}; font-weight:${a===t(d)?"bold":"normal"};`),f(B,`${((y=t(m)[t(i).speaker])==null?void 0:y.name)??""}:`),K(x,`font-size:${t(z)??""}; margin-bottom:5px;`),f(M,t(i).text)}),b("click",s,()=>S(a)),T(e,s)}),o(D),o(C);var L=v(C,2),F=r(L),at=r(F,!0);o(F);var O=v(F,2),ot=r(O);o(O);var I=v(O,2),rt=r(I,!0);o(I);var P=v(I,2),it=r(P,!0);o(P);var G=v(P,2),st=r(G,!0);o(G),o(L),o(X),q(()=>{K(D,`padding:20px; overflow-y:auto; width:${t(E)?"60%":"100%"}; max-height:100%;`),f(at,t(k)?"일시정지":"재생"),f(ot,`반복: ${t(h)==="none"?"없음":t(h)==="all"?"전체":"구간"}`),f(rt,t(j)?"한글 ON":"한글 OFF"),f(it,t(z)==="1.2em"?"크게 OFF":"크게 ON"),f(st,t(E)?"사진 보임":"사진 숨김")}),b("click",F,Y),b("click",O,Z),b("click",I,()=>n(j,!t(j))),b("click",P,()=>n(z,t(z)==="1.2em"?"2em":"1.2em")),b("click",G,()=>n(E,!t(E))),T(g,X),ct(),V()}export{Kt as component};
