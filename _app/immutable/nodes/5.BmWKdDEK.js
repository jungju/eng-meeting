import{t as F,e as b,a as T,s as f,c as Mt}from"../chunks/4zatZMyn.js";import"../chunks/CuG-qJQg.js";import{a9 as Tt,aa as y,ab as Ct,f as ct,t as Y,ac as Dt,s as u,g as t,a as s,l as a,m as ut,c as r,r as l,af as It,ad as Rt,R as pt}from"../chunks/Dyt7jpIe.js";import{i as vt}from"../chunks/js5uGENf.js";import{e as zt,i as Gt}from"../chunks/D_BNwrMf.js";import{s as Ot}from"../chunks/DKvFlRHg.js";import{s as X}from"../chunks/aPhAocpD.js";import{s as Pt}from"../chunks/DwwtOsHy.js";import{b as Vt}from"../chunks/DNHbLls4.js";import{i as Xt}from"../chunks/DDVUy9QN.js";import{s as Ft,a as Ht}from"../chunks/BMHBtBG6.js";import{o as Jt,a as Nt}from"../chunks/_OyF5GcO.js";import{p as Qt}from"../chunks/Vt7IgUII.js";import{b as Ut}from"../chunks/B3GUe6n2.js";var Wt=F('<div><div class="ln svelte-psujq8"><span class="idx svelte-psujq8"></span> <div><div> </div> <div> </div></div></div></div>'),Yt=F("<p>로딩...</p>"),Zt=F('<div class="ctrls svelte-psujq8"><button class="play svelte-psujq8"> </button> <button class="svelte-psujq8"> </button> <button> </button> <button class="svelte-psujq8"> </button> <button class="svelte-psujq8"> </button> <button class="svelte-psujq8"> </button> <button class="svelte-psujq8"> </button></div>'),te=F('<div class="list svelte-psujq8"><!></div> <!> <button class="bar svelte-psujq8"> </button> <audio playsinline="" preload="auto" style="display:none"></audio>',1);function _e(dt,ft){Tt(ft,!1);const[_t,mt]=Ft(),Z=()=>Ht(Qt,"$page",_t),C=s(),H=s(),tt=s(),et=s(),at=s();let _=s([]),st=s([]),p=s(-1),c=s(),h=s(!1),i=s("none"),D=s(!1),ot=[],S=null;const J=[0,1e3,3e3,5e3];let A=s(0),g=s("both"),k=s("eng"),q=s(!0);const bt=100,N=[1,2,3,5];let I=s(0),R=s(N[0]),z=0,nt=s(0),B=[];Jt(async()=>{if(!t(C))return;const e=await fetch(`${t(H)}/sentences.json`);if(e.ok){const o=await e.json();a(_,o.sentences),a(st,o.korean)}}),Nt(()=>{var e;(e=t(c))==null||e.pause(),S&&clearTimeout(S)});async function w(e){var o;e<0||e>=t(_).length||(e!==t(p)&&(z=0),a(p,e),await Rt(),(o=document.getElementById(`s-${e}`))==null||o.scrollIntoView({behavior:"smooth",block:"center"}),B=t(k)==="both"?["audio","audiok"]:t(k)==="kor"?["audiok"]:["audio"],await rt())}async function rt(){if(!B.length){a(h,!1);return}const e=B.shift();t(c).pause(),ut(c,t(c).src=`${t(H)}/${e}/${String(t(p)+1).padStart(2,"0")}.mp3`);try{await t(c).play(),a(h,!0)}catch{a(h,!1)}}function ht(){S=setTimeout(async()=>{if(B.length){await rt();return}if(t(i)==="one"){await w(t(p));return}if(t(i)==="all"){if(++z<t(R)){await w(t(p));return}z=0;const e=(t(p)+1)%t(_).length;if(!e&&It(nt)>=bt){a(h,!1),a(i,"none");return}await w(e);return}++z<t(R)?await w(t(p)):a(h,!1)},J[t(A)])}const gt=()=>t(h)?(t(c).pause(),a(h,!1),B=[],S&&clearTimeout(S)):w(t(p)===-1?0:t(p)),kt=()=>a(i,t(i)==="none"?"one":t(i)==="one"?"all":"none"),xt=()=>{t(i)!=="one"&&a(I,(t(I)+1)%N.length)},yt=()=>a(k,t(k)==="eng"?"kor":t(k)==="kor"?"both":"eng"),$t=()=>{a(D,!t(D)),t(D)?(ot=[...t(_)],a(_,t(_).map(e=>{const o=e.split(" "),v=o.length,K=v<=2?1:v>=10?3:2,d=new Set;for(;d.size<K;)d.add(Math.floor(Math.random()*v));return o.map((m,n)=>d.has(n)?"____":m).join(" ")}))):a(_,[...ot])},jt=()=>a(g,t(g)==="both"?"hideKor":t(g)==="hideKor"?"hideEng":"both"),qt=()=>a(A,(t(A)+1)%J.length),wt=()=>a(q,!t(q));y(()=>Z(),()=>{var e;a(C,((e=Z().url.pathname.match(/\/sentence\/([^\/]+)/))==null?void 0:e[1])||"")}),y(()=>t(C),()=>{a(H,`${Ut}/assets/sentence/${t(C)}`)}),y(()=>t(I),()=>{a(R,N[t(I)])}),y(()=>t(q),()=>{a(tt,t(q)?"calc(60px + env(safe-area-inset-bottom))":"env(safe-area-inset-bottom)")}),y(()=>t(g),()=>{a(et,t(g)==="both"?"한/영":t(g)==="hideKor"?"영":"한")}),y(()=>t(k),()=>{a(at,t(k)==="eng"?"영":t(k)==="kor"?"한":"모두")}),y(()=>t(i),()=>{t(i)!=="all"&&a(nt,0)}),y(()=>t(c),()=>{t(c)&&ut(c,t(c).onended=ht)}),Ct(),Xt();var lt=te(),G=ct(lt),Et=r(G);{var St=e=>{var o=Mt(),v=ct(o);zt(v,1,()=>t(_),Gt,(K,d,m)=>{var n=Wt();Ot(n,"id",`s-${m}`);var L=r(n),P=r(L);P.textContent=`${m+1}.`;var $=u(P,2),E=r($);let j;var Q=r(E,!0);l(E);var x=u(E,2);let V;var M=r(x,!0);l(x),l($),l(L),l(n),Y((U,W)=>{X(n,1,`sent ${m===t(p)?"act":""}`,"svelte-psujq8"),j=X(E,1,"en svelte-psujq8",null,j,U),f(Q,t(d)),V=X(x,1,"ko svelte-psujq8",null,V,W),f(M,t(st)[m])},[()=>({hidden:t(g)==="hideEng"}),()=>({hidden:t(g)==="hideKor"})],pt),b("click",n,()=>w(m)),T(K,n)}),T(e,o)},At=e=>{var o=Yt();T(e,o)};vt(Et,e=>{t(_).length?e(St):e(At,!1)})}l(G);var it=u(G,2);{var Bt=e=>{var o=Zt(),v=r(o),K=r(v,!0);l(v);var d=u(v,2),m=r(d);l(d);var n=u(d,2);let L;var P=r(n);l(n);var $=u(n,2),E=r($,!0);l($);var j=u($,2),Q=r(j,!0);l(j);var x=u(j,2),V=r(x);l(x);var M=u(x,2),U=r(M);l(M),l(o),Y(W=>{f(K,t(h)?"⏸":"▶"),f(m,`반복:${t(i)==="none"?"없음":t(i)==="one"?"문장":"전체"}`),n.disabled=t(i)==="one",L=X(n,1,"svelte-psujq8",null,L,W),f(P,`횟수:${t(R)??""}x`),f(E,t(et)),f(Q,t(D)?"원문":"빈칸"),f(V,`음성:${t(at)??""}`),f(U,`간격:${t(A)?J[t(A)]/1e3+"s":"즉시"}`)},[()=>({dis:t(i)==="one"})],pt),b("click",v,gt),b("click",d,kt),b("click",n,xt),b("click",$,jt),b("click",j,$t),b("click",x,yt),b("click",M,qt),T(e,o)};vt(it,e=>{t(q)&&e(Bt)})}var O=u(it,2),Kt=r(O,!0);l(O);var Lt=u(O,2);Vt(Lt,e=>a(c,e),()=>t(c)),Y(()=>{Pt(G,`bottom:${t(tt)}`),f(Kt,t(q)?"▽":"▲")}),b("click",O,wt),T(dt,lt),Dt(),mt()}export{_e as component};
