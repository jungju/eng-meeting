import{t as h,a as _,s as A,e as G,c as Ge}from"../chunks/DTjkHpgP.js";import"../chunks/DGCDY87e.js";import{a6 as Xe,a7 as c,a8 as Fe,f as Y,a9 as Je,g as e,a as r,s as g,e as a,ac as Pe,aa as Qe,ab as Ve,m as be,c as f,r as v,t as H,O as Ye}from"../chunks/C1n7QiUv.js";import{i as K}from"../chunks/DxuJ5YGS.js";import{e as Ze,i as et}from"../chunks/CKqkeeWi.js";import{s as tt}from"../chunks/35GQtHY4.js";import{b as at}from"../chunks/DAIErdJE.js";import{i as rt}from"../chunks/CRfTq02u.js";import{s as nt,a as st}from"../chunks/BcbruM5h.js";import{o as ot,a as it}from"../chunks/Dk0LuR_j.js";import{p as lt}from"../chunks/BJ57T1Yb.js";import{b as ct}from"../chunks/BA7HluVP.js";import{C as pt}from"../chunks/B1AnoRyH.js";var dt=h('<div class="remain-big"> </div>'),ft=h('<p class="eng"> </p>'),vt=h('<p class="placeholder">•••</p>'),ut=h('<p class="kor"> </p> <!>',1),_t=h('<p class="eng full"> </p>'),gt=h('<div role="button" tabindex="0"><div class="order-big"> </div> <!> <!></div> <button class="next-btn">NEXT ⏭</button>',1),mt=h('<div class="result-item" role="button" tabindex="0"><span class="num"></span> <span class="eng txt"> </span> <span class="kor txt"> </span></div>'),ht=h('<div class="result-list"><h2>재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),kt=h('<main class="wrapper"><!> <!></main> <!> <audio playsinline="" preload="auto"></audio>',1);function jt(xe,ye){Xe(ye,!1);const[$e,we]=nt(),ce=()=>st(lt,"$page",$e),Z=r(),D=r(),pe=r(),de=r(),k=r(),m=r(),ee=r(),X=r(),te=r(),ae=r(),fe=r(),re=[1e4,2e4,3e4,-1],ne=[10,20,50,-1];let F=r(0),J=r(0),b=r([]),se=r([]),i=r(-1),P=r(0),l=r(),x=r(!1),u=r(!1),C=!1,O=r(0),$;const y=new Set;let w=r([]),ve="kor",I=r(!1),p=r(0),S=r("kor");ot(()=>(fetch(`${e(D)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a(b,t.sentences),a(se,t.korean))}),window.addEventListener("keydown",ue),()=>window.removeEventListener("keydown",ue))),it(()=>{var t;(t=e(l))==null||t.pause(),clearInterval($)});function ue(t){if(!e(I)){if(["Space","ArrowRight"].includes(t.code))t.preventDefault(),E();else if(t.code==="ArrowLeft"&&e(w).length>1){t.preventDefault();const n=e(w).pop();n!==void 0&&y.delete(n),a(P,e(w).length),j(e(w).at(-1),!1,"eng")}}}function Ie(){if(e(m)>=0&&y.size>=e(m)||y.size===e(b).length)return-1;let t;do t=Math.floor(Math.random()*e(b).length);while(y.has(t));return t}async function j(t,n=!0,s="kor"){if(ve=s,!(t<0||t>=e(b).length)){n&&Qe(P),a(i,t),y.add(t),n&&e(w).push(t),await Ve(),e(l).pause(),be(l,e(l).src=`${s==="kor"?e(de):e(pe)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(l).play(),a(x,!0)}catch{C=!0}}}function Se(){be(l,e(l).onended=()=>{if(a(x,!1),C){C=!1,E();return}ve==="eng"||e(m)>=0&&y.size>=e(m)||e(m)<0&&y.size===e(b).length||e(k)>=0&&_e()})}function _e(){e(k)<0||(e(u)&&clearInterval($),a(u,!0),a(O,Math.ceil(e(k)/1e3)),$=setInterval(()=>{Pe(O,-1)<=0&&(clearInterval($),a(u,!1),e(x)?C=!0:E())},1e3))}function E(){e(l).pause(),clearInterval($),a(x,a(u,C=!1)),a(O,0);const t=Ie();if(t===-1){a(I,!0);return}j(t,!0,e(S))}const Ee=(t,n)=>n===1?"_".repeat(t.length):n===2?t[0]+"_".repeat(t.length-1):t,Le=t=>e(p)===4?t:e(p)===3?t.split(" ").map((n,s)=>s%2?"_".repeat(n.length):n).join(" "):e(p)>0?t.split(" ").map(n=>Ee(n,e(p))).join(" "):"",oe=()=>{e(l).pause(),clearInterval($),a(x,a(u,C=!1)),a(i,-1),a(P,a(O,0)),y.clear(),a(w,[]),a(I,!1)},Ae=()=>e(x)||e(u)||e(I)?oe():E(),De=(t=!1)=>a(p,(e(p)+(t?-1:1)+5)%5),Ce=()=>{a(S,e(S)==="kor"?"eng":"kor"),e(i)!==-1&&!e(I)&&j(e(i),!1,e(S))},ge=t=>j(t,!1,"eng");function Oe(t){const{id:n,backward:s=!1}=t.detail;switch(n){case"count":a(J,(e(J)+(s?-1:1)+ne.length)%ne.length),oe();break;case"gap":a(F,(e(F)+(s?-1:1)+re.length)%re.length),e(u)&&(clearInterval($),a(u,!1),_e());break;case"start":Ae();break;case"hint":De(s);break;case"caption":Ce();break}}c(()=>ce(),()=>{a(Z,ce().params.id)}),c(()=>e(Z),()=>{a(D,`${ct}/assets/sentence/${e(Z)}`)}),c(()=>e(D),()=>{a(pe,`${e(D)}/audio`)}),c(()=>e(D),()=>{a(de,`${e(D)}/audiok`)}),c(()=>e(F),()=>{a(k,re[e(F)])}),c(()=>e(J),()=>{a(m,ne[e(J)])}),c(()=>e(l),()=>{e(l)&&Se()}),c(()=>e(m),()=>{a(ee,e(m)<0?"전체":`${e(m)}개`)}),c(()=>(e(x),e(u)),()=>{a(X,e(x)||e(u))}),c(()=>e(k),()=>{a(te,e(k)<0?"∞":`${e(k)/1e3}s`)}),c(()=>e(p),()=>{a(ae,`H${e(p)}`)}),c(()=>(e(X),e(ee),e(ae),e(p),e(S),e(te)),()=>{a(fe,[{id:"start",icon:e(X)?"⏹":"▶"},{id:"count",text:`출제:${e(ee)}`},{id:"hint",text:e(ae),active:e(p)>0},{id:"caption",text:e(S)==="kor"?"한":"영"},{id:"gap",text:e(te)}])}),Fe(),rt();var me=kt(),ie=Y(me),he=f(ie);{var je=t=>{var n=gt(),s=Y(n),T=f(s),z=f(T,!0);v(T);var Q=g(T,2);{var L=o=>{var d=dt(),M=f(d,!0);v(d),H(()=>A(M,e(O))),_(o,d)};K(Q,o=>{e(k)>=0&&e(O)>0&&o(L)})}var V=g(Q,2);{var U=o=>{var d=Ge(),M=Y(d);{var Be=R=>{var B=ut(),W=Y(B),He=f(W,!0);v(W);var Ke=g(W,2);{var Te=N=>{var q=ft(),We=f(q,!0);v(q),H(qe=>A(We,qe),[()=>Le(e(b)[e(i)])],Ye),_(N,q)},Ue=N=>{var q=vt();_(N,q)};K(Ke,N=>{e(p)>0?N(Te):N(Ue,!1)})}H(()=>A(He,e(se)[e(i)])),_(R,B)},Ne=R=>{var B=_t(),W=f(B,!0);v(B),H(()=>A(W,e(b)[e(i)])),_(R,B)};K(M,R=>{e(S)==="kor"?R(Be):R(Ne,!1)})}_(o,d)};K(V,o=>{e(i)!==-1&&o(U)})}v(s);var le=g(s,2);H(()=>{tt(s,1,`sentence-box ${e(X)?"playing":""}`),A(z,e(i)===-1?"Ready":`#${e(P)}`)}),G("click",s,function(...o){var d;(d=e(i)===-1?E:()=>j(e(i),!1,"eng"))==null||d.apply(this,o)}),G("keydown",s,o=>["Enter"," "].includes(o.key)&&(o.preventDefault(),e(i)===-1?E():j(e(i),!1,"eng"))),G("click",le,E),_(t,n)};K(he,t=>{e(I)||t(je)})}var ze=g(he,2);{var Me=t=>{var n=ht(),s=g(f(n),2);Ze(s,1,()=>e(w),et,(T,z,Q)=>{var L=mt(),V=f(L);V.textContent=`${Q+1}.`;var U=g(V,2),le=f(U,!0);v(U);var o=g(U,2),d=f(o,!0);v(o),v(L),H(()=>{A(le,e(b)[e(z)]),A(d,e(se)[e(z)])}),G("click",L,()=>ge(e(z))),G("keydown",L,M=>["Enter"," "].includes(M.key)&&(M.preventDefault(),ge(e(z)))),_(T,L)}),v(n),_(t,n)};K(ze,t=>{e(I)&&t(Me)})}v(ie);var ke=g(ie,2);pt(ke,{get buttons(){return e(fe)},$$events:{click:Oe}});var Re=g(ke,2);at(Re,t=>a(l,t),()=>e(l)),_(xe,me),Je(),we()}export{jt as component};
