import{t as N,e as h,a as j,s as _,c as Et}from"../chunks/4zatZMyn.js";import"../chunks/CuG-qJQg.js";import{a9 as Mt,aa as E,ab as St,f as et,t as V,ac as Tt,s as u,g as t,a as s,l as a,c as n,r as l,m as at,ad as Bt,R as Kt}from"../chunks/Dyt7jpIe.js";import{i as ot}from"../chunks/js5uGENf.js";import{e as jt,i as At}from"../chunks/D_BNwrMf.js";import{s as Ct}from"../chunks/DKvFlRHg.js";import{s as z}from"../chunks/aPhAocpD.js";import{s as Gt}from"../chunks/DwwtOsHy.js";import{b as It}from"../chunks/DNHbLls4.js";import{i as Lt}from"../chunks/DDVUy9QN.js";import{s as Dt,a as Rt}from"../chunks/BMHBtBG6.js";import{o as qt,a as Nt}from"../chunks/_OyF5GcO.js";import{p as Pt}from"../chunks/nomUDxwQ.js";import{b as Qt}from"../chunks/EVmmLd5B.js";var Vt=N('<div><div class="line svelte-1p9wxoe"><div class="idx svelte-1p9wxoe"></div> <div class="content svelte-1p9wxoe"><div> </div> <div> </div></div></div></div>'),zt=N('<p class="loading svelte-1p9wxoe">문장 데이터를 불러오는 중입니다...</p>'),Ft=N('<div class="controls svelte-1p9wxoe"><button class="play-btn svelte-1p9wxoe"> </button> <button class="svelte-1p9wxoe"> </button> <button class="svelte-1p9wxoe"> </button> <button class="svelte-1p9wxoe"> </button> <button class="svelte-1p9wxoe"> </button> <button class="svelte-1p9wxoe"> </button></div>'),Ht=N('<div class="list svelte-1p9wxoe"><!></div> <!> <button class="bar-toggle svelte-1p9wxoe"> </button> <audio playsinline="" preload="auto" style="display:none"></audio>',1);function re(st,nt){Mt(nt,!1);const[lt,rt]=Dt(),F=()=>Rt(Pt,"$page",lt),A=s(),P=s(),H=s(),J=s(),O=s();let d=s([]),U=s([]),g=s(-1),r=s(),x=s(!1),w=s("none"),C=s(!1),W=[],y=null;const Q=[0,1e3,3e3,5e3];let M=s(0),m=s("both"),b=s("eng"),$=s(!0);qt(async()=>{if(!t(A))return;const e=await fetch(`${t(P)}/sentences.json`);if(e.ok){const o=await e.json();a(d,o.sentences),a(U,o.korean)}}),Nt(()=>{var e;(e=t(r))==null||e.pause(),y&&clearTimeout(y)});let S=[];async function G(e){var o;e<0||e>=t(d).length||(a(g,e),await Bt(),(o=document.getElementById(`s-${e}`))==null||o.scrollIntoView({behavior:"smooth",block:"center"}),S=t(b)==="both"?["audio","audiok"]:t(b)==="kor"?["audiok"]:["audio"],await X())}async function X(){if(!S.length){a(x,!1);return}const e=S.shift();t(r).pause(),at(r,t(r).src=`${t(P)}/${e}/${String(t(g)+1).padStart(2,"0")}.mp3`);try{await t(r).play(),a(x,!0)}catch{a(x,!1)}}function it(){at(r,t(r).onended=()=>{y=setTimeout(async()=>{if(S.length){await X();return}t(w)==="one"?G(t(g)):t(w)==="all"?G((t(g)+1)%t(d).length):a(x,!1)},Q[t(M)])})}function ct(){t(x)?(t(r).pause(),a(x,!1),S=[],y&&(clearTimeout(y),y=null)):G(t(g)===-1?0:t(g))}function vt(){a(w,t(w)==="none"?"one":t(w)==="one"?"all":"none")}function pt(){a(b,t(b)==="eng"?"kor":t(b)==="kor"?"both":"eng")}function ut(){a(C,!t(C)),t(C)?(W=[...t(d)],a(d,t(d).map(e=>{const o=e.split(" "),p=o.length,T=p<=2?1:p>=10?3:2,c=[];for(;c.length<T;){const i=Math.floor(Math.random()*p);c.includes(i)||c.push(i)}return c.forEach(i=>o[i]="____"),o.join(" ")}))):a(d,[...W])}function dt(){a(m,t(m)==="both"?"hideKor":t(m)==="hideKor"?"hideEng":"both")}function ft(){a(M,(t(M)+1)%Q.length)}function _t(){a($,!t($))}E(()=>F(),()=>{var e;a(A,((e=F().url.pathname.match(/\/sentence\/([^\/]+)/))==null?void 0:e[1])||"")}),E(()=>t(A),()=>{a(P,`${Qt}/assets/sentence/${t(A)}`)}),E(()=>t(m),()=>{a(H,t(m)==="both"?"한/영":t(m)==="hideKor"?"영":"한")}),E(()=>t(b),()=>{a(J,t(b)==="eng"?"영":t(b)==="kor"?"한":"모두")}),E(()=>t($),()=>{a(O,t($)?"calc(60px + env(safe-area-inset-bottom))":"env(safe-area-inset-bottom)")}),E(()=>t(r),()=>{t(r)&&it()}),St(),Lt();var Y=Ht(),I=et(Y),mt=n(I);{var bt=e=>{var o=Et(),p=et(o);jt(p,1,()=>t(d),At,(T,c,i)=>{var v=Vt();Ct(v,"id",`s-${i}`);var D=n(v),k=n(D);k.textContent=`${i+1}.`;var R=u(k,2),f=n(R);let q;var B=n(f,!0);l(f);var K=u(f,2);let tt;var kt=n(K,!0);l(K),l(R),l(D),l(v),V((yt,$t)=>{z(v,1,`sent ${i===t(g)?"active":""}`,"svelte-1p9wxoe"),q=z(f,1,"text svelte-1p9wxoe",null,q,yt),_(B,t(c)),tt=z(K,1,"kor svelte-1p9wxoe",null,tt,$t),_(kt,t(U)[i])},[()=>({hidden:t(m)==="hideEng"}),()=>({hidden:t(m)==="hideKor"})],Kt),h("click",v,()=>G(i)),j(T,v)}),j(e,o)},ht=e=>{var o=zt();j(e,o)};ot(mt,e=>{t(d).length?e(bt):e(ht,!1)})}l(I);var Z=u(I,2);{var gt=e=>{var o=Ft(),p=n(o),T=n(p,!0);l(p);var c=u(p,2),i=n(c);l(c);var v=u(c,2),D=n(v,!0);l(v);var k=u(v,2),R=n(k,!0);l(k);var f=u(k,2),q=n(f);l(f);var B=u(f,2),K=n(B);l(B),l(o),V(()=>{_(T,t(x)?"⏸":"▶"),_(i,`반복:${t(w)==="none"?"없음":t(w)==="one"?"문장":"전체"}`),_(D,t(H)),_(R,t(C)?"원문 보기":"빈칸"),_(q,`음성:${t(J)??""}`),_(K,`간격:${t(M)===0?"즉시":`${Q[t(M)]/1e3}초`}`)}),h("click",p,ct),h("click",c,vt),h("click",v,dt),h("click",k,ut),h("click",f,pt),h("click",B,ft),j(e,o)};ot(Z,e=>{t($)&&e(gt)})}var L=u(Z,2),xt=n(L,!0);l(L);var wt=u(L,2);It(wt,e=>a(r,e),()=>t(r)),V(()=>{Gt(I,`bottom:${t(O)}`),_(xt,t($)?"▽":"▲")}),h("click",L,_t),j(st,Y),Tt(),rt()}export{re as component};
