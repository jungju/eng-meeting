import"../chunks/NZTpNUN0.js";import{i as Fe}from"../chunks/BNVjIjhF.js";import{p as Ie,a2 as d,a3 as qe,t as M,f as de,e as F,a as w,b as Ge,l as t,g as e,s as $,m as o,a8 as Ne,a6 as ce,d as h,r as _,a4 as Pe,a9 as Re,c as Ve,h as I,a5 as fe}from"../chunks/CX7M6nTm.js";import{i as Y}from"../chunks/LrUez5h3.js";import{e as Xe,i as He}from"../chunks/DribQdv5.js";import{s as Je}from"../chunks/p6kCGZxg.js";import{s as K}from"../chunks/DF-Yt0Lv.js";import{b as Qe}from"../chunks/7ANmUOF5.js";import{s as Ue,a as We}from"../chunks/CJtuwylV.js";import{o as Ye,a as Ze}from"../chunks/zff4H6P-.js";import{p as et}from"../chunks/CAoeJScB.js";import{b as tt}from"../chunks/D_HJ-Yzb.js";import{C as at}from"../chunks/J-pJPzLO.js";var ot=M("<div> </div>"),st=M('<span style="position:absolute;right:8px;top:8px;font-size:1.2rem;opacity:.7"> </span>'),nt=M('<div role="button" tabindex="0"><div style="display:flex;align-items:center"><span style="margin-right:.5rem;color:#6b7280;font-weight:bold"></span><div style="flex:1 1 auto"><div> </div><div> </div><!></div></div><!></div>'),rt=M('<p style="padding:1rem">로딩...</p>'),it=M('<div class="list svelte-1xcy4ta"><!></div> <!> <audio playsinline="" preload="auto" style="display:none"></audio>',1);function kt(ue,me){Ie(me,!1);const[ve,be]=Ue(),Z=()=>We(et,"$page",ve),S=o(),q=o(),ee=o(),G=o(),N=o(),P=o(),R=o(),te=o();let f=o([]),ae=o([]),V=o([]),n=o(-1),r=o(),s=o(!1),l=o("all"),E=o(!1),oe=[],B=null;const X=[0,1e3,3e3,5e3];let x=o(0),v=o("both"),b=o("eng"),H=o(!0),C=o(!0),ge=100,J=[1,3,5,10],T=o(0),y=o(J[0]),c=o(0),se=o(0),L=[];Ye(async()=>{if(!e(S))return;const a=await fetch(`${e(q)}/sentences.json`);if(a.ok){const p=await a.json();t(f,p.sentences),t(ae,p.korean),t(V,p.explanations??[])}}),Ze(()=>{e(r)?.pause(),B&&clearTimeout(B)});async function k(a){a<0||a>=e(f).length||(a!==e(n)&&t(c,0),t(n,a),await Ne(),document.getElementById(`s-${a}`)?.scrollIntoView({behavior:"smooth",block:"center"}),L=e(b)==="both"?["audio","audiok"]:e(b)==="kor"?["audiok"]:["audio"],await ne())}async function ne(){if(!L.length){t(s,!1);return}const a=L.shift();e(r).pause(),ce(r,e(r).src=`${e(q)}/${a}/${String(e(n)+1).padStart(2,"0")}.mp3`);try{await e(r).play(),t(s,!0)}catch{t(s,!1)}}function he(){B=setTimeout(async()=>{if(L.length)return await ne();if(Pe(c),e(l)==="all"){if(e(c)<e(y))return await k(e(n));t(c,0);const a=(e(n)+1)%e(f).length;if(!a&&Re(se)>=ge){t(s,!1),t(l,"none");return}return await k(a)}if(e(l)==="one"){if(e(c)<e(y))return await k(e(n));t(s,!1);return}if(e(c)<e(y))return await k(e(n));t(s,!1)},X[e(x)])}const _e=()=>e(s)?(e(r).pause(),t(s,!1),L=[],B&&clearTimeout(B)):k(e(n)===-1?0:e(n)),ye=()=>{t(l,e(l)==="none"?"one":e(l)==="one"?"all":"none"),t(c,0)},ke=()=>{t(T,(e(T)+1)%J.length),t(c,0)},xe=()=>{t(b,e(b)==="eng"?"kor":e(b)==="kor"?"both":"eng")},we=()=>{t(E,!e(E)),e(E)?(oe=[...e(f)],t(f,e(f).map(a=>{const p=a.split(" "),z=p.length,Q=z<=2?1:z>=10?3:2,A=new Set;for(;A.size<Q;)A.add(Math.floor(Math.random()*z));return p.map((i,u)=>A.has(u)?"____":i).join(" ")}))):t(f,[...oe])},$e=()=>t(v,e(v)==="both"?"hideKor":e(v)==="hideKor"?"hideEng":"both"),Ee=()=>t(x,(e(x)+1)%X.length),Be=()=>t(C,!e(C));function Ce(a){switch(a.detail.id){case"play":_e();break;case"repeat":ye();break;case"count":ke();break;case"disp":$e();break;case"blank":we();break;case"audio":xe();break;case"gap":Ee();break;case"exp":Be();break}}d(()=>Z(),()=>{t(S,Z().url.pathname.match(/\/sentence\/([^\/]+)/)?.[1]||"")}),d(()=>e(S),()=>{t(q,`${tt}/assets/sentence/${e(S)}`)}),d(()=>e(T),()=>{t(y,J[e(T)])}),d(()=>e(H),()=>{t(ee,e(H)?"calc(60px + env(safe-area-inset-bottom))":"env(safe-area-inset-bottom)")}),d(()=>e(l),()=>{e(l)!=="all"&&t(se,0)}),d(()=>e(r),()=>{e(r)&&ce(r,e(r).onended=he)}),d(()=>e(x),()=>{t(G,e(x)?X[e(x)]/1e3+"s":"즉시")}),d(()=>e(v),()=>{t(N,e(v)==="both"?"한/영":e(v)==="hideKor"?"영":"한")}),d(()=>e(b),()=>{t(P,e(b)==="eng"?"영":e(b)==="kor"?"한":"모두")}),d(()=>e(C),()=>{t(R,e(C)?"설명ON":"설명OFF")}),d(()=>(e(s),e(l),e(y),e(N),e(E),e(P),e(G),e(R)),()=>{t(te,[{id:"play",icon:e(s)?"⏸":"▶"},{id:"repeat",text:"반복:"+(e(l)==="none"?"없음":e(l)==="one"?"문장":"전체")},{id:"count",text:"횟수:"+e(y)+"x",active:!0},{id:"disp",text:e(N)},{id:"blank",text:e(E)?"원문":"빈칸"},{id:"audio",text:"음성:"+e(P)},{id:"gap",text:"간격:"+e(G)},{id:"exp",text:e(R)}])}),qe(),Fe();var re=it(),j=de(re),Le=h(j);{var ze=a=>{var p=Ve(),z=de(p);Xe(z,1,()=>e(f),He,(Q,A,i)=>{var u=nt();Je(u,"id",`s-${i}`);var U=h(u),le=h(U);le.textContent=`${i+1}.`;var pe=$(le),O=h(pe),Me=h(O,!0);_(O);var D=$(O),Se=h(D,!0);_(D);var Te=$(D);{var je=m=>{var g=ot(),W=h(g,!0);_(g),F(()=>{K(g,`font-size:2.6rem;color:#6b7280;margin-top:.25rem;display:${e(C)?"block":"none"}`),I(W,e(V)[i])}),w(m,g)};Y(Te,m=>{e(V)[i]&&m(je)})}_(pe),_(U);var Oe=$(U);{var De=m=>{var g=st(),W=h(g,!0);_(g),F(()=>I(W,e(c)+1)),w(m,g)};Y(Oe,m=>{e(s)&&i===e(n)&&m(De)})}_(u),F(()=>{K(u,`position:relative;padding:1rem;margin:.5rem 0;border-radius:.5rem;cursor:pointer;background:${e(s)&&i===e(n)?e(c)+1===e(y)?"#ffe3e3":"#d0ebff":"#f9f9f9"};${e(s)&&i===e(n)?"font-weight:bold;":""}`),K(O,`font-size:3.2rem;display:${e(v)==="hideEng"?"none":"block"}`),I(Me,e(A)),K(D,`font-size:3.2rem;color:#374151;margin-top:.25rem;display:${e(v)==="hideKor"?"none":"block"}`),I(Se,e(ae)[i])}),fe("click",u,()=>k(i)),fe("keydown",u,m=>["Enter"," "].includes(m.key)&&k(i)),w(Q,u)}),w(a,p)},Ae=a=>{var p=rt();w(a,p)};Y(Le,a=>{e(f).length?a(ze):a(Ae,!1)})}_(j);var ie=$(j,2);at(ie,{get buttons(){return e(te)},$$events:{click:Ce,toggle:a=>t(H,a.detail.visible)}});var Ke=$(ie,2);Qe(Ke,a=>t(r,a),()=>e(r)),F(()=>K(j,`position:absolute;top:50px;left:0;right:0;bottom:${e(ee)};overflow-y:auto`)),w(ue,re),Ge(),be()}export{kt as component};
