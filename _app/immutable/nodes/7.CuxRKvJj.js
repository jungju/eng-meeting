import"../chunks/NZTpNUN0.js";import{i as Ge}from"../chunks/C1kFBjD0.js";import{p as Ne,a3 as r,a4 as Pe,t as F,f as pe,h as J,a as C,b as Re,o as t,g as e,d as s,s as L,a8 as Ve,m as ue,e as _,r as b,a9 as Xe,c as He,K as ve,i as Q,a6 as fe}from"../chunks/kc4YAh9y.js";import{i as me}from"../chunks/meG6WkfV.js";import{e as Je,i as Qe}from"../chunks/BvPctM3R.js";import{s as Ue}from"../chunks/DfUw6pHB.js";import{s as D}from"../chunks/D8RCsmFZ.js";import{s as We}from"../chunks/DBe_9k9b.js";import{b as Ye}from"../chunks/eT6sziqz.js";import{s as Ze,a as et}from"../chunks/CxXm-2W8.js";import{o as tt,a as at}from"../chunks/B6AwUu_V.js";import{p as st}from"../chunks/B-yuKAca.js";import{b as ot}from"../chunks/D2KPaHUa.js";import{C as nt}from"../chunks/Dw7rxz5s.js";var it=F("<div> </div>"),rt=F('<div role="button" tabindex="0"><div class="ln svelte-1xcy4ta"><span class="idx svelte-1xcy4ta"></span> <div><div> </div> <div> </div> <!></div></div></div>'),lt=F("<p>로딩...</p>"),ct=F('<div class="list svelte-1xcy4ta"><!></div> <!> <audio playsinline="" preload="auto" style="display:none"></audio>',1);function $t(he,_e){Ne(_e,!1);const[be,ge]=Ze(),U=()=>et(st,"$page",be),K=s(),I=s(),W=s(),z=s(),G=s(),N=s(),P=s(),Y=s();let d=s([]),Z=s([]),R=s([]),l=s(-1),n=s(),p=s(!1),o=s("none"),k=s(!1),ee=[],y=null;const V=[0,1e3,3e3,5e3];let g=s(0),v=s("both"),f=s("eng"),A=s(!0),M=s(!0),xe=100,X=[1,2,3,5],S=s(0),w=s(X[0]),T=0,te=s(0),$=[];tt(async()=>{if(!e(K))return;const a=await fetch(`${e(I)}/sentences.json`);if(a.ok){const i=await a.json();t(d,i.sentences),t(Z,i.korean),t(R,i.explanations??[])}}),at(()=>{e(n)?.pause(),y&&clearTimeout(y)});async function m(a){a<0||a>=e(d).length||(a!==e(l)&&(T=0),t(l,a),await Ve(),document.getElementById(`s-${a}`)?.scrollIntoView({behavior:"smooth",block:"center"}),$=e(f)==="both"?["audio","audiok"]:e(f)==="kor"?["audiok"]:["audio"],await ae())}async function ae(){if(!$.length){t(p,!1);return}const a=$.shift();e(n).pause(),ue(n,e(n).src=`${e(I)}/${a}/${String(e(l)+1).padStart(2,"0")}.mp3`);try{await e(n).play(),t(p,!0)}catch{t(p,!1)}}function ke(){y=setTimeout(async()=>{if($.length)return await ae();if(e(o)==="one")return await m(e(l));if(e(o)==="all"){if(++T<e(w))return await m(e(l));T=0;const a=(e(l)+1)%e(d).length;if(!a&&Xe(te)>=xe){t(p,!1),t(o,"none");return}return await m(a)}++T<e(w)?await m(e(l)):t(p,!1)},V[e(g)])}const ye=()=>e(p)?(e(n).pause(),t(p,!1),$=[],y&&clearTimeout(y)):m(e(l)===-1?0:e(l)),we=()=>t(o,e(o)==="none"?"one":e(o)==="one"?"all":"none"),$e=()=>{e(o)!=="one"&&t(S,(e(S)+1)%X.length)},Ee=()=>t(f,e(f)==="eng"?"kor":e(f)==="kor"?"both":"eng"),Be=()=>{t(k,!e(k)),e(k)?(ee=[...e(d)],t(d,e(d).map(a=>{const i=a.split(" "),E=i.length,H=E<=2?1:E>=10?3:2,B=new Set;for(;B.size<H;)B.add(Math.floor(Math.random()*E));return i.map((c,u)=>B.has(u)?"____":c).join(" ")}))):t(d,[...ee])},Ce=()=>t(v,e(v)==="both"?"hideKor":e(v)==="hideKor"?"hideEng":"both"),Le=()=>t(g,(e(g)+1)%V.length),Ke=()=>t(M,!e(A));function Ae(a){switch(a.detail.id){case"play":ye();break;case"repeat":we();break;case"count":$e();break;case"disp":Ce();break;case"blank":Be();break;case"audio":Ee();break;case"gap":Le();break;case"exp":Ke();break}}r(()=>U(),()=>{t(K,U().url.pathname.match(/\/sentence\/([^\/]+)/)?.[1]||"")}),r(()=>e(K),()=>{t(I,`${ot}/assets/sentence/${e(K)}`)}),r(()=>e(S),()=>{t(w,X[e(S)])}),r(()=>e(A),()=>{t(W,e(A)?"calc(60px + env(safe-area-inset-bottom))":"env(safe-area-inset-bottom)")}),r(()=>e(o),()=>{e(o)!=="all"&&t(te,0)}),r(()=>e(n),()=>{e(n)&&ue(n,e(n).onended=ke)}),r(()=>e(g),()=>{t(z,e(g)?V[e(g)]/1e3+"s":"즉시")}),r(()=>e(v),()=>{t(G,e(v)==="both"?"한/영":e(v)==="hideKor"?"영":"한")}),r(()=>e(f),()=>{t(N,e(f)==="eng"?"영":e(f)==="kor"?"한":"모두")}),r(()=>e(M),()=>{t(P,e(M)?"설명ON":"설명OFF")}),r(()=>(e(p),e(o),e(w),e(G),e(k),e(N),e(z),e(P)),()=>{t(Y,[{id:"play",icon:e(p)?"⏸":"▶"},{id:"repeat",text:"반복:"+(e(o)==="none"?"없음":e(o)==="one"?"문장":"전체")},{id:"count",text:"횟수:"+e(w)+"x",active:e(o)!=="one"},{id:"disp",text:e(G)},{id:"blank",text:e(k)?"원문":"빈칸"},{id:"audio",text:"음성:"+e(N)},{id:"gap",text:"간격:"+e(z)},{id:"exp",text:e(P)}])}),Pe(),Ge();var se=ct(),j=pe(se),Me=_(j);{var Se=a=>{var i=He(),E=pe(i);Je(E,1,()=>e(d),Qe,(H,B,c)=>{var u=rt();Ue(u,"id",`s-${c}`);var ne=_(u),ie=_(ne);ie.textContent=`${c+1}.`;var re=L(ie,2),O=_(re);let le;var Oe=_(O,!0);b(O);var q=L(O,2);let ce;var qe=_(q,!0);b(q);var De=L(q,2);{var Fe=h=>{var x=it();let de;var Ie=_(x,!0);b(x),J(ze=>{de=D(x,1,"ex svelte-1xcy4ta",null,de,ze),Q(Ie,e(R)[c])},[()=>({hidden:!e(M)})],ve),C(h,x)};me(De,h=>{e(R)[c]&&h(Fe)})}b(re),b(ne),b(u),J((h,x)=>{D(u,1,`sent ${c===e(l)?"act":""}`,"svelte-1xcy4ta"),le=D(O,1,"en svelte-1xcy4ta",null,le,h),Q(Oe,e(B)),ce=D(q,1,"ko svelte-1xcy4ta",null,ce,x),Q(qe,e(Z)[c])},[()=>({hidden:e(v)==="hideEng"}),()=>({hidden:e(v)==="hideKor"})],ve),fe("click",u,()=>m(c)),fe("keydown",u,h=>["Enter"," "].includes(h.key)&&m(c)),C(H,u)}),C(a,i)},Te=a=>{var i=lt();C(a,i)};me(Me,a=>{e(d).length?a(Se):a(Te,!1)})}b(j);var oe=L(j,2);nt(oe,{get buttons(){return e(Y)},$$events:{click:Ae,toggle:a=>t(A,a.detail.visible)}});var je=L(oe,2);Ye(je,a=>t(n,a),()=>e(n)),J(()=>We(j,`bottom:${e(W)}`)),C(he,se),Re(),ge()}export{$t as component};
