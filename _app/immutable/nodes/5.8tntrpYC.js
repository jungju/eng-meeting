import{t as x,a as h,s as K,e as T}from"../chunks/CMAwb4th.js";import"../chunks/CthApk8F.js";import{a6 as He,a7 as l,a8 as Te,f as oe,a9 as Ue,g as e,a as r,s as u,e as a,ac as We,ab as qe,aa as Ge,m as be,c as _,r as g,t as U,O as Xe}from"../chunks/DnBkWd9o.js";import{i as M}from"../chunks/3lh4epU4.js";import{e as Fe,i as Je}from"../chunks/D7qEBDdj.js";import{s as Pe}from"../chunks/DH_McDNf.js";import{b as Qe}from"../chunks/M8wP0stW.js";import{i as Ve}from"../chunks/RqZXrTMm.js";import{s as Ye,a as Ze}from"../chunks/CKqP-jYq.js";import{o as et,a as tt}from"../chunks/xvpwIJTT.js";import{p as at}from"../chunks/BNpQ36iJ.js";import{b as rt}from"../chunks/CIZJrGic.js";import{C as st}from"../chunks/CeMdoRY0.js";var nt=x('<div class="remain-big svelte-d4jx2b"> </div>'),ot=x('<p class="kor svelte-d4jx2b"> </p>'),it=x('<p class="eng svelte-d4jx2b"> </p>'),lt=x('<p class="placeholder svelte-d4jx2b">•••</p>'),ct=x("<!> <!>",1),dt=x('<div role="button" tabindex="0"><div class="order-big svelte-d4jx2b"> </div> <!> <!></div> <button class="next-btn svelte-d4jx2b">NEXT ⏭</button>',1),pt=x('<div class="result-item svelte-d4jx2b" role="button" tabindex="0"><span class="num svelte-d4jx2b"></span><span class="eng txt svelte-d4jx2b"> </span><span class="kor txt svelte-d4jx2b"> </span></div>'),vt=x('<div class="result-list svelte-d4jx2b"><h2 class="svelte-d4jx2b">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),ft=x('<main class="wrapper svelte-d4jx2b"><!> <!></main> <!> <audio playsinline="" preload="auto" class="svelte-d4jx2b"></audio>',1);function St(he,xe){He(xe,!1);const[ke,ye]=Ye(),ie=()=>Ze(at,"$page",ke),P=r(),A=r(),le=r(),ce=r(),k=r(),m=r(),Q=r(),W=r(),V=r(),Y=r(),de=r(),Z=[1e4,2e4,3e4,-1],ee=[10,20,50,-1];let q=r(0),G=r(0),$=r([]),te=r([]),p=r(-1),X=r(0),i=r(),y=r(!1),v=r(!1),D=!1,O=r(0),w;const j=new Set;let I=r([]),pe="kor",z=r(!1),c=r(0),R=r(!0);et(()=>(fetch(`${e(A)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a($,t.sentences),a(te,t.korean))}),window.addEventListener("keydown",ve),()=>window.removeEventListener("keydown",ve))),tt(()=>{var t;(t=e(i))==null||t.pause(),clearInterval(w)});function ve(t){if(!e(z)){if(["Space","ArrowRight"].includes(t.code))t.preventDefault(),S();else if(t.code==="ArrowLeft"&&e(I).length>1){t.preventDefault();const s=e(I).pop();s!==void 0&&j.delete(s),a(X,e(I).length),B(e(I).at(-1),!1,"eng")}}}function je(){if(e(m)>=0&&j.size>=e(m)||j.size===e($).length)return-1;let t;do t=Math.floor(Math.random()*e($).length);while(j.has(t));return t}async function B(t,s=!0,n="kor"){if(pe=n,!(t<0||t>=e($).length)){s&&qe(X),a(p,t),j.add(t),s&&e(I).push(t),await Ge(),e(i).pause(),be(i,e(i).src=`${n==="kor"?e(ce):e(le)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(i).play(),a(y,!0)}catch{D=!0}}}function $e(){e(i)&&be(i,e(i).onended=()=>{if(a(y,!1),D){D=!1,S();return}pe==="eng"||e(m)>=0&&j.size>=e(m)||e(m)<0&&j.size===e($).length||e(k)>=0&&fe()})}function fe(){e(k)<0||(e(v)&&clearInterval(w),a(v,!0),a(O,Math.ceil(e(k)/1e3)),w=setInterval(()=>{We(O,-1)<=0&&(clearInterval(w),a(v,!1),e(y)?D=!0:S())},1e3))}function S(){e(i).pause(),clearInterval(w),a(y,a(v,D=!1)),a(O,0);const t=je();if(t===-1){a(z,!0);return}B(t,!0,"kor")}const we=(t,s)=>s===1?"_".repeat(t.length):s===2?t[0]+"_".repeat(t.length-1):t,Ie=t=>e(c)===4?t:e(c)===3?t.split(" ").map((s,n)=>n%2?"_".repeat(s.length):s).join(" "):e(c)>0?t.split(" ").map(s=>we(s,e(c))).join(" "):"",ae=()=>{e(i).pause(),clearInterval(w),a(y,a(v,D=!1)),a(p,-1),a(X,a(O,0)),j.clear(),a(I,[]),a(z,!1)},Se=()=>e(y)||e(v)||e(z)?ae():S();function Ee(t=!1){a(c,(e(c)+(t?-1:1)+5)%5)}const Le=()=>a(R,!e(R)),ue=t=>B(t,!1,"eng");function Ae(t){const{id:s,backward:n=!1}=t.detail;switch(s){case"count":a(G,(e(G)+(n?-1:1)+ee.length)%ee.length),ae();break;case"gap":a(q,(e(q)+(n?-1:1)+Z.length)%Z.length),e(v)&&(clearInterval(w),a(v,!1),fe());break;case"start":Se();break;case"hint":Ee(n);break;case"kor":Le();break}}l(()=>ie(),()=>{a(P,ie().params.id)}),l(()=>e(P),()=>{a(A,`${rt}/assets/sentence/${e(P)}`)}),l(()=>e(A),()=>{a(le,`${e(A)}/audio`)}),l(()=>e(A),()=>{a(ce,`${e(A)}/audiok`)}),l(()=>e(q),()=>{a(k,Z[e(q)])}),l(()=>e(G),()=>{a(m,ee[e(G)])}),l(()=>e(i),()=>{e(i)&&$e()}),l(()=>e(m),()=>{a(Q,e(m)<0?"전체":e(m)+"개")}),l(()=>(e(y),e(v)),()=>{a(W,e(y)||e(v))}),l(()=>e(k),()=>{a(V,e(k)<0?"∞":`${e(k)/1e3}s`)}),l(()=>e(c),()=>{a(Y,`H${e(c)}`)}),l(()=>(e(W),e(Q),e(Y),e(c),e(R),e(V)),()=>{a(de,[{id:"start",icon:e(W)?"⏹":"▶"},{id:"count",text:`출제:${e(Q)}`},{id:"hint",text:e(Y),active:e(c)>0},{id:"kor",text:e(R)?"가":"한"},{id:"gap",text:e(V)}])}),Te(),Ve();var _e=ft(),re=oe(_e),ge=_(re);{var De=t=>{var s=dt(),n=oe(s),N=_(n),C=_(N,!0);g(N);var F=u(N,2);{var E=o=>{var d=nt(),L=_(d,!0);g(d),U(()=>K(L,e(O))),h(o,d)};M(F,o=>{e(k)>=0&&e(O)>0&&o(E)})}var J=u(F,2);{var H=o=>{var d=ct(),L=oe(d);{var Ke=f=>{var b=ot(),ne=_(b,!0);g(b),U(()=>K(ne,e(te)[e(p)])),h(f,b)};M(L,f=>{e(R)&&f(Ke)})}var Me=u(L,2);{var Re=f=>{var b=it(),ne=_(b,!0);g(b),U(Ne=>K(ne,Ne),[()=>Ie(e($)[e(p)])],Xe),h(f,b)},Be=f=>{var b=lt();h(f,b)};M(Me,f=>{e(c)>0?f(Re):f(Be,!1)})}h(o,d)};M(J,o=>{e(p)!==-1&&o(H)})}g(n);var se=u(n,2);U(()=>{Pe(n,1,`sentence-box ${e(W)?"playing":""}`,"svelte-d4jx2b"),K(C,e(p)===-1?"Ready":`#${e(X)}`)}),T("click",n,function(...o){var d;(d=e(p)===-1?S:()=>B(e(p),!1,"eng"))==null||d.apply(this,o)}),T("keydown",n,o=>["Enter"," "].includes(o.key)&&(o.preventDefault(),e(p)===-1?S():B(e(p),!1,"eng"))),T("click",se,S),h(t,s)};M(ge,t=>{e(z)||t(De)})}var Oe=u(ge,2);{var ze=t=>{var s=vt(),n=u(_(s),2);Fe(n,1,()=>e(I),Je,(N,C,F)=>{var E=pt(),J=_(E);J.textContent=`${F+1}.`;var H=u(J),se=_(H,!0);g(H);var o=u(H),d=_(o,!0);g(o),g(E),U(()=>{K(se,e($)[e(C)]),K(d,e(te)[e(C)])}),T("click",E,()=>ue(e(C))),T("keydown",E,L=>["Enter"," "].includes(L.key)&&(L.preventDefault(),ue(e(C)))),h(N,E)}),g(s),h(t,s)};M(Oe,t=>{e(z)&&t(ze)})}g(re);var me=u(re,2);st(me,{get buttons(){return e(de)},$$events:{click:Ae}});var Ce=u(me,2);Qe(Ce,t=>a(i,t),()=>e(i)),h(he,_e),Ue(),ye()}export{St as component};
