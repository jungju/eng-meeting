import{t as j,a as y,s as K,e as T}from"../chunks/CMAwb4th.js";import"../chunks/CthApk8F.js";import{a6 as Ne,g as e,e as a,a7 as l,a8 as He,f as oe,a9 as Te,a as r,s as m,ac as Ue,ab as We,aa as qe,m as me,c as b,r as h,t as U,O as Ge}from"../chunks/DnBkWd9o.js";import{i as M}from"../chunks/3lh4epU4.js";import{e as Xe,i as Fe}from"../chunks/D7qEBDdj.js";import{s as Je}from"../chunks/DH_McDNf.js";import{b as Pe}from"../chunks/M8wP0stW.js";import{i as Qe}from"../chunks/RqZXrTMm.js";import{s as Ve,a as Ye}from"../chunks/CKqP-jYq.js";import{o as Ze,a as et}from"../chunks/xvpwIJTT.js";import{p as tt}from"../chunks/DLe6iUsB.js";import{b as at}from"../chunks/BcijdcKj.js";import{C as rt}from"../chunks/CeMdoRY0.js";var st=j('<div class="remain-big svelte-d4jx2b"> </div>'),nt=j('<p class="kor svelte-d4jx2b"> </p>'),ot=j('<p class="eng svelte-d4jx2b"> </p>'),it=j('<p class="placeholder svelte-d4jx2b">•••</p>'),lt=j("<!> <!>",1),ct=j('<div role="button" tabindex="0"><div class="order-big svelte-d4jx2b"> </div> <!> <!></div> <button class="next-btn svelte-d4jx2b">NEXT ⏭</button>',1),dt=j('<div class="result-item svelte-d4jx2b" role="button" tabindex="0"><span class="num svelte-d4jx2b"></span><span class="eng txt svelte-d4jx2b"> </span><span class="kor txt svelte-d4jx2b"> </span></div>'),pt=j('<div class="result-list svelte-d4jx2b"><h2 class="svelte-d4jx2b">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),vt=j('<main class="wrapper svelte-d4jx2b"><!> <!></main> <!> <audio playsinline="" preload="auto" class="svelte-d4jx2b"></audio>',1);function It(be,he){Ne(he,!1);const[xe,ke]=Ve(),ie=()=>Ye(tt,"$page",xe),J=r(),z=r(),le=r(),ce=r(),$=r(),v=r(),P=r(),W=r(),Q=r(),V=r(),de=r(),Y=[1e4,2e4,3e4,-1],Z=[10,20,50,-1];let q=r(0),G=r(0),f=r([]),ee=r([]),u=r(-1),te=r(0),i=r(),w=r(!1),_=r(!1),A=!1,D=r(0),I;const c=new Set;let O=r([]),x=r(!1),d=r(0),R=r(!0);Ze(()=>(fetch(`${e(z)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a(f,t.sentences),a(ee,t.korean))}),window.addEventListener("keydown",pe),()=>window.removeEventListener("keydown",pe))),et(()=>{var t;(t=e(i))==null||t.pause(),clearInterval(I)});function pe(t){e(x)||(["Space","ArrowRight"].includes(t.code)?(t.preventDefault(),S()):t.code==="ArrowLeft"&&e(O).length>1&&(t.preventDefault(),e(O).pop(),B(e(O).at(-1),!1,"eng")))}function ye(){if(e(v)>=0&&c.size>=e(v)||c.size===e(f).length)return-1;let t;do t=Math.floor(Math.random()*e(f).length);while(c.has(t));return t}(e(v)<0?c.size===e(f).length:c.size===e(v))&&a(x,!0);async function B(t,s=!0,n="kor"){if(!(t<0||t>=e(f).length)){s&&We(te),a(u,t),c.add(t),s&&e(O).push(t),await qe(),e(i).pause(),me(i,e(i).src=`${n==="kor"?e(ce):e(le)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(i).play(),a(w,!0)}catch{A=!0}}}function je(){if(!e(i))return;me(i,e(i).onended=()=>{if(a(w,!1),A){A=!1,S();return}if(e($)>=0&&c.size<e(f).length){ve();return}c.size===e(f).length&&a(x,!0)}),(e(v)<0?c.size===e(f).length:c.size===e(v))&&a(x,!0)}function ve(){e($)<0||(e(_)&&clearInterval(I),a(_,!0),a(D,Math.ceil(e($)/1e3)),I=setInterval(()=>{Ue(D,-1)<=0&&(clearInterval(I),a(_,!1),e(w)?A=!0:S())},1e3))}function S(){e(i).pause(),clearInterval(I),a(w,a(_,A=!1)),a(D,0);const t=ye();if(t===-1){a(x,!0);return}B(t,!0,"kor")}const $e=(t,s)=>s===1?"_".repeat(t.length):s===2?t[0]+"_".repeat(t.length-1):t,we=t=>e(d)===4?t:e(d)===3?t.split(" ").map((s,n)=>n%2?"_".repeat(s.length):s).join(" "):e(d)>0?t.split(" ").map(s=>$e(s,e(d))).join(" "):"",ae=()=>{e(i).pause(),clearInterval(I),a(w,a(_,A=!1)),a(u,-1),a(te,a(D,0)),c.clear(),a(O,[]),a(x,!1)},Ie=()=>e(w)||e(_)||e(x)?ae():S();function Se(t=!1){a(d,(e(d)+(t?-1:1)+5)%5)}const Ee=()=>a(R,!e(R)),fe=t=>B(t,!1,"eng");function Le(t){const{id:s,backward:n=!1}=t.detail;switch(s){case"count":a(G,(e(G)+(n?-1:1)+Z.length)%Z.length),ae();break;case"gap":a(q,(e(q)+(n?-1:1)+Y.length)%Y.length),e(_)&&(clearInterval(I),a(_,!1),ve());break;case"start":Ie();break;case"hint":Se(n);break;case"kor":Ee();break}}l(()=>ie(),()=>{a(J,ie().params.id)}),l(()=>e(J),()=>{a(z,`${at}/assets/sentence/${e(J)}`)}),l(()=>e(z),()=>{a(le,`${e(z)}/audio`)}),l(()=>e(z),()=>{a(ce,`${e(z)}/audiok`)}),l(()=>e(q),()=>{a($,Y[e(q)])}),l(()=>e(G),()=>{a(v,Z[e(G)])}),l(()=>e(i),()=>{e(i)&&je()}),l(()=>e(v),()=>{a(P,e(v)<0?"전체":e(v)+"개")}),l(()=>(e(w),e(_)),()=>{a(W,e(w)||e(_))}),l(()=>e($),()=>{a(Q,e($)<0?"∞":`${e($)/1e3}s`)}),l(()=>e(d),()=>{a(V,`H${e(d)}`)}),l(()=>(e(W),e(P),e(V),e(d),e(R),e(Q)),()=>{a(de,[{id:"start",icon:e(W)?"⏹":"▶"},{id:"count",text:`출제:${e(P)}`},{id:"hint",text:e(V),active:e(d)>0},{id:"kor",text:e(R)?"가":"한"},{id:"gap",text:e(Q)}])}),He(),Qe();var ue=vt(),re=oe(ue),_e=b(re);{var ze=t=>{var s=ct(),n=oe(s),N=b(n),C=b(N,!0);h(N);var X=m(N,2);{var E=o=>{var p=st(),L=b(p,!0);h(p),U(()=>K(L,e(D))),y(o,p)};M(X,o=>{e($)>=0&&e(D)>0&&o(E)})}var F=m(X,2);{var H=o=>{var p=lt(),L=oe(p);{var Ce=g=>{var k=nt(),ne=b(k,!0);h(k),U(()=>K(ne,e(ee)[e(u)])),y(g,k)};M(L,g=>{e(R)&&g(Ce)})}var Ke=m(L,2);{var Me=g=>{var k=ot(),ne=b(k,!0);h(k),U(Be=>K(ne,Be),[()=>we(e(f)[e(u)])],Ge),y(g,k)},Re=g=>{var k=it();y(g,k)};M(Ke,g=>{e(d)>0?g(Me):g(Re,!1)})}y(o,p)};M(F,o=>{e(u)!==-1&&o(H)})}h(n);var se=m(n,2);U(()=>{Je(n,1,`sentence-box ${e(W)?"playing":""}`,"svelte-d4jx2b"),K(C,e(u)===-1?"Ready":`#${e(te)}`)}),T("click",n,function(...o){var p;(p=e(u)===-1?S:()=>B(e(u),!1,"eng"))==null||p.apply(this,o)}),T("keydown",n,o=>["Enter"," "].includes(o.key)&&(o.preventDefault(),e(u)===-1?S():B(e(u),!1,"eng"))),T("click",se,S),y(t,s)};M(_e,t=>{e(x)||t(ze)})}var Ae=m(_e,2);{var De=t=>{var s=pt(),n=m(b(s),2);Xe(n,1,()=>e(O),Fe,(N,C,X)=>{var E=dt(),F=b(E);F.textContent=`${X+1}.`;var H=m(F),se=b(H,!0);h(H);var o=m(H),p=b(o,!0);h(o),h(E),U(()=>{K(se,e(f)[e(C)]),K(p,e(ee)[e(C)])}),T("click",E,()=>fe(e(C))),T("keydown",E,L=>["Enter"," "].includes(L.key)&&(L.preventDefault(),fe(e(C)))),y(N,E)}),h(s),y(t,s)};M(Ae,t=>{e(x)&&t(De)})}h(re);var ge=m(re,2);rt(ge,{get buttons(){return e(de)},$$events:{click:Le}});var Oe=m(ge,2);Pe(Oe,t=>a(i,t),()=>e(i)),y(be,ue),Te(),ke()}export{It as component};
