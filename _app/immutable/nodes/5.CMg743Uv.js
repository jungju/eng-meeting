import{t as $,a as y,s as K,e as T}from"../chunks/CMAwb4th.js";import"../chunks/CthApk8F.js";import{a6 as Ne,g as e,e as a,a7 as l,a8 as He,f as oe,a9 as Te,a as r,s as g,ac as Ue,ab as We,aa as qe,m as ge,c as m,r as k,t as U,O as Ge}from"../chunks/DnBkWd9o.js";import{i as M}from"../chunks/3lh4epU4.js";import{e as Xe,i as Fe}from"../chunks/D7qEBDdj.js";import{s as Je}from"../chunks/DH_McDNf.js";import{b as Pe}from"../chunks/M8wP0stW.js";import{i as Qe}from"../chunks/RqZXrTMm.js";import{s as Ve,a as Ye}from"../chunks/CKqP-jYq.js";import{o as Ze,a as et}from"../chunks/xvpwIJTT.js";import{p as tt}from"../chunks/ChhebCpv.js";import{b as at}from"../chunks/CjXIvG_A.js";import{C as rt}from"../chunks/CeMdoRY0.js";var st=$('<div class="remain-big svelte-1h60khx"> </div>'),nt=$('<p class="kor svelte-1h60khx"> </p>'),ot=$('<p class="eng svelte-1h60khx"> </p>'),it=$('<p class="placeholder svelte-1h60khx">•••</p>'),lt=$("<!> <!>",1),ct=$('<div role="button" tabindex="0"><div class="order-big svelte-1h60khx"> </div> <!> <!></div> <button class="next-btn svelte-1h60khx">NEXT ⏭</button>',1),pt=$('<div class="result-item svelte-1h60khx" role="button" tabindex="0"><span class="num svelte-1h60khx"></span><span class="eng txt svelte-1h60khx"> </span><span class="kor txt svelte-1h60khx"> </span></div>'),vt=$('<div class="result-list svelte-1h60khx"><h2 class="svelte-1h60khx">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),dt=$('<main class="wrapper svelte-1h60khx"><!> <!></main> <!> <audio playsinline="" preload="auto" class="svelte-1h60khx"></audio>',1);function St(me,ke){Ne(ke,!1);const[xe,be]=Ve(),ie=()=>Ye(tt,"$page",xe),J=r(),A=r(),le=r(),ce=r(),w=r(),d=r(),P=r(),W=r(),Q=r(),V=r(),pe=r(),Y=[1e4,2e4,3e4,-1],Z=[10,20,50,-1];let q=r(0),G=r(0),f=r([]),ee=r([]),u=r(-1),te=r(0),i=r(),I=r(!1),h=r(!1),D=!1,O=r(0),S;const c=new Set;let j=r([]),x=r(!1),p=r(0),R=r(!0);Ze(()=>(fetch(`${e(A)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a(f,t.sentences),a(ee,t.korean))}),window.addEventListener("keydown",ve),()=>window.removeEventListener("keydown",ve))),et(()=>{var t;(t=e(i))==null||t.pause(),clearInterval(S)});function ve(t){e(x)||(["Space","ArrowRight"].includes(t.code)?(t.preventDefault(),E()):t.code==="ArrowLeft"&&e(j).length>1&&(t.preventDefault(),e(j).pop(),B(e(j).at(-1),!1,"eng")))}function ye(){if(e(d)>=0&&c.size>=e(d)||c.size===e(f).length)return-1;let t;do t=Math.floor(Math.random()*e(f).length);while(c.has(t));return t}(e(d)<0?c.size===e(f).length:c.size===e(d))&&a(x,!0);async function B(t,s=!0,n="kor"){if(!(t<0||t>=e(f).length)){s&&We(te),a(u,t),c.add(t),s&&e(j).push(t),await qe(),e(i).pause(),ge(i,e(i).src=`${n==="kor"?e(ce):e(le)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(i).play(),a(I,!0)}catch{D=!0}}}function $e(){if(!e(i))return;ge(i,e(i).onended=()=>{if(a(I,!1),D){D=!1,E();return}if(e(w)>=0&&c.size<e(f).length){de();return}c.size===e(f).length&&a(x,!0)}),(e(d)<0?c.size===e(f).length:c.size===e(d))&&a(x,!0)}function de(){e(w)<0||(e(h)&&clearInterval(S),a(h,!0),a(O,Math.ceil(e(w)/1e3)),S=setInterval(()=>{Ue(O,-1)<=0&&(clearInterval(S),a(h,!1),e(I)?D=!0:E())},1e3))}function E(){e(i).pause(),clearInterval(S),a(I,a(h,D=!1)),a(O,0);const t=ye();if(t===-1){a(x,!0);return}B(t,!0,"kor")}const we=(t,s)=>s===1?"_".repeat(t.length):s===2?t[0]+"_".repeat(t.length-1):t,Ie=t=>e(p)===4?t:e(p)===3?t.split(" ").map((s,n)=>n%2?"_".repeat(s.length):s).join(" "):e(p)>0?t.split(" ").map(s=>we(s,e(p))).join(" "):"",ae=()=>{e(i).pause(),clearInterval(S),a(I,a(h,D=!1)),a(u,-1),a(te,a(O,0)),c.clear(),a(j,[]),a(x,!1)},Se=()=>e(I)||e(h)||e(x)?ae():E();function Ee(t=!1){a(p,(e(p)+(t?-1:1)+5)%5)}const Le=()=>a(R,!e(R)),fe=t=>B(t,!1,"eng");function ze(t){const{id:s,backward:n=!1}=t.detail;switch(s){case"count":a(G,(e(G)+(n?-1:1)+Z.length)%Z.length),ae();break;case"gap":a(q,(e(q)+(n?-1:1)+Y.length)%Y.length),e(h)&&(clearInterval(S),a(h,!1),de());break;case"start":Se();break;case"hint":Ee(n);break;case"kor":Le();break}}l(()=>ie(),()=>{a(J,ie().params.id)}),l(()=>e(J),()=>{a(A,`${at}/assets/sentence/${e(J)}`)}),l(()=>e(A),()=>{a(le,`${e(A)}/audio`)}),l(()=>e(A),()=>{a(ce,`${e(A)}/audiok`)}),l(()=>e(q),()=>{a(w,Y[e(q)])}),l(()=>e(G),()=>{a(d,Z[e(G)])}),l(()=>e(i),()=>{e(i)&&$e()}),l(()=>e(d),()=>{a(P,e(d)<0?"전체":e(d)+"개")}),l(()=>(e(I),e(h)),()=>{a(W,e(I)||e(h))}),l(()=>e(w),()=>{a(Q,e(w)<0?"∞":`${e(w)/1e3}s`)}),l(()=>e(p),()=>{a(V,`H${e(p)}`)}),l(()=>(e(W),e(P),e(V),e(p),e(R),e(Q)),()=>{a(pe,[{id:"start",icon:e(W)?"⏹":"▶"},{id:"count",text:`출제:${e(P)}`},{id:"hint",text:e(V),active:e(p)>0},{id:"kor",text:e(R)?"가":"한"},{id:"gap",text:e(Q)}])}),He(),Qe();var ue=dt(),re=oe(ue),he=m(re);{var Ae=t=>{var s=ct(),n=oe(s),N=m(n),C=m(N,!0);k(N);var X=g(N,2);{var L=o=>{var v=st(),z=m(v,!0);k(v),U(()=>K(z,e(O))),y(o,v)};M(X,o=>{e(w)>=0&&e(O)>0&&o(L)})}var F=g(X,2);{var H=o=>{var v=lt(),z=oe(v);{var Ce=_=>{var b=nt(),ne=m(b,!0);k(b),U(()=>K(ne,e(ee)[e(u)])),y(_,b)};M(z,_=>{e(R)&&_(Ce)})}var Ke=g(z,2);{var Me=_=>{var b=ot(),ne=m(b,!0);k(b),U(Be=>K(ne,Be),[()=>Ie(e(f)[e(u)])],Ge),y(_,b)},Re=_=>{var b=it();y(_,b)};M(Ke,_=>{e(p)>0?_(Me):_(Re,!1)})}y(o,v)};M(F,o=>{e(u)!==-1&&o(H)})}k(n);var se=g(n,2);U(()=>{Je(n,1,`sentence-box ${e(W)?"playing":""}`,"svelte-1h60khx"),K(C,e(u)===-1?"Ready":`#${e(te)}`)}),T("click",n,function(...o){var v;(v=e(u)===-1?E:()=>B(e(u),!1,"eng"))==null||v.apply(this,o)}),T("keydown",n,o=>["Enter"," "].includes(o.key)&&(o.preventDefault(),e(u)===-1?E():B(e(u),!1,"eng"))),T("click",se,E),y(t,s)};M(he,t=>{e(x)||t(Ae)})}var De=g(he,2);{var Oe=t=>{var s=vt(),n=g(m(s),2);Xe(n,1,()=>e(j),Fe,(N,C,X)=>{var L=pt(),F=m(L);F.textContent=`${X+1}.`;var H=g(F),se=m(H,!0);k(H);var o=g(H),v=m(o,!0);k(o),k(L),U(()=>{K(se,e(f)[e(C)]),K(v,e(ee)[e(C)])}),T("click",L,()=>fe(e(C))),T("keydown",L,z=>["Enter"," "].includes(z.key)&&(z.preventDefault(),fe(e(C)))),y(N,L)}),k(s),y(t,s)};M(De,t=>{e(x)&&t(Oe)})}k(re);var _e=g(re,2);rt(_e,{get buttons(){return e(pe)},$$events:{click:ze}});var je=g(_e,2);Pe(je,t=>a(i,t),()=>e(i)),y(me,ue),Te(),be()}export{St as component};
