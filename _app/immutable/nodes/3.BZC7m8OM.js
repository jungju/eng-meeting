import{t as T,e as h,a as M,s as m}from"../chunks/DUxGASJm.js";import"../chunks/DX_I1LvE.js";import{h as H,a3 as nt,a7 as lt,a8 as dt,t as N,a5 as pt,a6 as f,c as n,g as t,m as v,s as l,r as a,a9 as ft}from"../chunks/CmuIngUP.js";import{i as J}from"../chunks/bw1FrMkY.js";import{e as vt,i as ct}from"../chunks/C_5jZkZv.js";import{s as L}from"../chunks/Bz4HwDwR.js";import{t as mt}from"../chunks/BQs9fFl7.js";import{i as ut}from"../chunks/Gu067PdZ.js";import{o as gt}from"../chunks/BvDnhw93.js";import{p as Q}from"../chunks/DHYdHODX.js";import{b as bt}from"../chunks/RAQ4RqVW.js";function X(u,$,c,g){var p=u.__style;if(H||p!==$){var o=mt($);(!H||o!==u.getAttribute("style"))&&(o==null?u.removeAttribute("style"):u.style.cssText=o),u.__style=$}return g}var xt=T('<div style="width:40%; background:#f0f0f0; display:flex; align-items:center; justify-content:center; position:relative;"><div style="position:absolute; top:10px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.3); color:#fff; padding:5px 10px; border-radius:5px; font-weight:bold;"> </div> <img style="max-width:90%; max-height:90%; border-radius:10px;"></div>'),ht=T("<div> </div>"),yt=T('<div><div style="color:#2a3d66; font-weight:bold; margin-bottom:5px; font-size:1.2em;"> </div> <div> </div> <!></div>'),_t=T('<div style="position:absolute; top:50px; left:0; right:0; bottom:0; display:flex; flex-direction:column; overflow:hidden;"><div style="flex:1; display:flex; overflow:hidden;"><!> <div style="flex:1; overflow-y:auto; padding:20px;"></div></div> <div style="background:#fff; padding:10px; border-top:1px solid #ccc; display:flex; justify-content:center; gap:8px;"><button style="width:110px; height:48px; font-size:0.8em;"> </button> <button style="width:110px; height:48px; font-size:0.8em;"> </button> <button style="width:110px; height:48px; font-size:0.8em;"> </button> <button style="width:110px; height:48px; font-size:0.8em;">크기</button> <button style="width:110px; height:48px; font-size:0.8em;"> </button></div></div>');function Pt(u,$){nt($,!1);const c=v(),g=`${bt}/assets/dialogue`;let p=v([]),o=v(0),d=null,y=v(!1),b=v("none"),z=v("1.2em"),S=v(!0),A=v(!0),E=v({});gt(async()=>{if(!t(c))return;const e=await fetch(`${g}/${t(c)}/dialogue.json`);if(e.ok){const r=await e.json();l(E,r.persons),l(p,r.conversation.map((i,s)=>({...i,filePath:`${g}/${t(c)}/audio/${String(s+1).padStart(2,"0")}.mp3`})))}});async function k(e){var i,s;if(e<0||e>=t(p).length){l(y,!1);return}d==null||d.pause(),l(o,e),await ft(),(i=document.getElementById(`segment-${e}`))==null||i.scrollIntoView({behavior:"smooth",block:"center"});const r=t(p)[e];d=new Audio(r.filePath),d.muted=(s=t(E)[r.speaker])==null?void 0:s.hideEnglish,d.onended=()=>{t(b)==="segment"?k(t(o)):t(o)<t(p).length-1?k(t(o)+1):t(b)==="all"?k(0):l(y,!1)},l(y,!0),d.play()}function U(){d?d.paused?(d.play(),l(y,!0)):(d.pause(),l(y,!1)):k(0)}function W(){l(b,t(b)==="none"?"all":t(b)==="all"?"segment":"none")}function Y(e){e.target.src=`${g}/${t(c)}/ready.webp`}lt(()=>Q,()=>{var e;l(c,((e=Q.url.pathname.match(/\/dialogue\/([^\/]+)/))==null?void 0:e[1])||"")}),dt(),ut();var K=_t(),R=n(K),q=n(R);{var Z=e=>{var r=xt(),i=n(r),s=n(i,!0);a(i);var _=f(i,2);a(r),N(()=>{var I,x,P;m(s,((x=t(E)[(I=t(p)[t(o)])==null?void 0:I.speaker])==null?void 0:x.name)||""),L(_,"src",(P=t(p)[t(o)])!=null&&P.speaker?`${g}/${t(c)}/${t(p)[t(o)].speaker}.webp`:`${g}/${t(c)}/ready.webp`)}),h("error",_,Y),M(e,r)};J(q,e=>{t(A)&&e(Z)})}var C=f(q,2);vt(C,5,()=>t(p),ct,(e,r,i)=>{var s=yt();L(s,"id",`segment-${i}`);var _=n(s),I=n(_);a(_);var x=f(_,2),P=n(x,!0);a(x);var rt=f(x,2);{var it=w=>{var B=ht(),st=n(B,!0);a(B),N(()=>{X(B,`font-size:${t(z)??""}; color:#555;`),m(st,t(r).korean)}),M(w,B)};J(rt,w=>{t(S)&&w(it)})}a(s),N(()=>{var w;X(s,`margin-bottom:15px; padding:10px; cursor:pointer; border-bottom:1px solid #ddd; background:${i===t(o)?"#d0f0d0":"transparent"}; font-weight:${i===t(o)?"bold":"normal"};`),m(I,`${((w=t(E)[t(r).speaker])==null?void 0:w.name)??""}:`),X(x,`font-size:${t(z)??""}; margin-bottom:5px;`),m(P,t(r).text)}),h("click",s,()=>k(i)),M(e,s)}),a(C),a(R);var D=f(R,2),j=n(D),tt=n(j,!0);a(j);var F=f(j,2),et=n(F);a(F);var O=f(F,2),at=n(O,!0);a(O);var G=f(O,2),V=f(G,2),ot=n(V,!0);a(V),a(D),a(K),N(()=>{m(tt,t(y)?"⏸":"▶"),m(et,`반복: ${t(b)==="none"?"없음":t(b)==="all"?"전체":"구간"}`),m(at,t(S)?"한글 ON":"한글 OFF"),m(ot,t(A)?"사진 ON":"사진 OFF")}),h("click",j,U),h("click",F,W),h("click",O,()=>l(S,!t(S))),h("click",G,()=>l(z,t(z)==="1.2em"?"2em":"1.2em")),h("click",V,()=>l(A,!t(A))),M(u,K),pt()}export{Pt as component};
