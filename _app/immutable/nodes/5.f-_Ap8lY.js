import{t as q,a as B,c as jt,s as m,e as f}from"../chunks/4zatZMyn.js";import"../chunks/CuG-qJQg.js";import{a9 as Ct,aa as y,ab as qt,f as ct,t as W,ac as Dt,s as v,g as t,a as o,l as a,m as vt,c as l,r as i,af as It,ad as Rt,R as ut}from"../chunks/Dyt7jpIe.js";import{i as dt}from"../chunks/js5uGENf.js";import{e as zt,i as Gt}from"../chunks/D_BNwrMf.js";import{s as Ot}from"../chunks/DKvFlRHg.js";import{s as X}from"../chunks/aPhAocpD.js";import{s as Pt}from"../chunks/DwwtOsHy.js";import{b as Vt}from"../chunks/DNHbLls4.js";import{i as Xt}from"../chunks/DDVUy9QN.js";import{s as Ft,a as Ht}from"../chunks/BMHBtBG6.js";import{o as Jt,a as Nt}from"../chunks/_OyF5GcO.js";import{p as Qt}from"../chunks/CFWSvgyc.js";import{b as Ut}from"../chunks/B1hQIAWi.js";var Wt=q('<div><div class="ln svelte-1g1oils"><span class="idx svelte-1g1oils"></span> <div><div> </div> <div> </div></div></div></div>'),Yt=q("<p>로딩...</p>"),Zt=q('<div class="ctrls svelte-1g1oils"><button class="btn play svelte-1g1oils"> </button> <button class="btn svelte-1g1oils"> </button> <button> </button> <button class="btn svelte-1g1oils"> </button> <button class="btn svelte-1g1oils"> </button> <button class="btn svelte-1g1oils"> </button> <button class="btn svelte-1g1oils"> </button> <button class="btn toggle svelte-1g1oils">▽</button></div>'),te=q('<button class="bar-fixed svelte-1g1oils">▲</button>'),ee=q('<div class="list svelte-1g1oils"><!></div> <!> <audio playsinline="" preload="auto" style="display:none"></audio>',1);function _e(pt,ft){Ct(ft,!1);const[bt,_t]=Ft(),Y=()=>Ht(Qt,"$page",bt),D=o(),F=o(),Z=o(),tt=o(),et=o();let b=o([]),at=o([]),u=o(-1),c=o(),g=o(!1),r=o("none"),I=o(!1),st=[],K=null;const H=[0,1e3,3e3,5e3];let L=o(0),h=o("both"),k=o("eng"),M=o(!0);const mt=100,J=[1,2,3,5];let R=o(0),z=o(J[0]),G=0,ot=o(0),T=[];Jt(async()=>{if(!t(D))return;const e=await fetch(`${t(F)}/sentences.json`);if(e.ok){const s=await e.json();a(b,s.sentences),a(at,s.korean)}}),Nt(()=>{var e;(e=t(c))==null||e.pause(),K&&clearTimeout(K)});async function E(e){var s;e<0||e>=t(b).length||(e!==t(u)&&(G=0),a(u,e),await Rt(),(s=document.getElementById(`s-${e}`))==null||s.scrollIntoView({behavior:"smooth",block:"center"}),T=t(k)==="both"?["audio","audiok"]:t(k)==="kor"?["audiok"]:["audio"],await nt())}async function nt(){if(!T.length){a(g,!1);return}const e=T.shift();t(c).pause(),vt(c,t(c).src=`${t(F)}/${e}/${String(t(u)+1).padStart(2,"0")}.mp3`);try{await t(c).play(),a(g,!0)}catch{a(g,!1)}}function gt(){K=setTimeout(async()=>{if(T.length){await nt();return}if(t(r)==="one"){await E(t(u));return}if(t(r)==="all"){if(++G<t(z)){await E(t(u));return}G=0;const e=(t(u)+1)%t(b).length;if(!e&&It(ot)>=mt){a(g,!1),a(r,"none");return}await E(e);return}++G<t(z)?await E(t(u)):a(g,!1)},H[t(L)])}const ht=()=>t(g)?(t(c).pause(),a(g,!1),T=[],K&&clearTimeout(K)):E(t(u)===-1?0:t(u)),kt=()=>a(r,t(r)==="none"?"one":t(r)==="one"?"all":"none"),xt=()=>{t(r)!=="one"&&a(R,(t(R)+1)%J.length)},yt=()=>a(k,t(k)==="eng"?"kor":t(k)==="kor"?"both":"eng"),$t=()=>{a(I,!t(I)),t(I)?(st=[...t(b)],a(b,t(b).map(e=>{const s=e.split(" "),d=s.length,j=d<=2?1:d>=10?3:2,p=new Set;for(;p.size<j;)p.add(Math.floor(Math.random()*d));return s.map((_,n)=>p.has(n)?"____":_).join(" ")}))):a(b,[...st])},wt=()=>a(h,t(h)==="both"?"hideKor":t(h)==="hideKor"?"hideEng":"both"),Et=()=>a(L,(t(L)+1)%H.length),lt=()=>a(M,!t(M));y(()=>Y(),()=>{var e;a(D,((e=Y().url.pathname.match(/\/sentence\/([^\/]+)/))==null?void 0:e[1])||"")}),y(()=>t(D),()=>{a(F,`${Ut}/assets/sentence/${t(D)}`)}),y(()=>t(R),()=>{a(z,J[t(R)])}),y(()=>t(M),()=>{a(Z,t(M)?"calc(60px + env(safe-area-inset-bottom))":"env(safe-area-inset-bottom)")}),y(()=>t(h),()=>{a(tt,t(h)==="both"?"한/영":t(h)==="hideKor"?"영":"한")}),y(()=>t(k),()=>{a(et,t(k)==="eng"?"영":t(k)==="kor"?"한":"모두")}),y(()=>t(r),()=>{t(r)!=="all"&&a(ot,0)}),y(()=>t(c),()=>{t(c)&&vt(c,t(c).onended=gt)}),qt(),Xt();var it=ee(),O=ct(it),St=l(O);{var At=e=>{var s=jt(),d=ct(s);zt(d,1,()=>t(b),Gt,(j,p,_)=>{var n=Wt();Ot(n,"id",`s-${_}`);var C=l(n),P=l(C);P.textContent=`${_+1}.`;var $=v(P,2),S=l($);let w;var N=l(S,!0);i(S);var x=v(S,2);let V;var A=l(x,!0);i(x),i($),i(C),i(n),W((Q,U)=>{X(n,1,`sent ${_===t(u)?"act":""}`,"svelte-1g1oils"),w=X(S,1,"en svelte-1g1oils",null,w,Q),m(N,t(p)),V=X(x,1,"ko svelte-1g1oils",null,V,U),m(A,t(at)[_])},[()=>({hidden:t(h)==="hideEng"}),()=>({hidden:t(h)==="hideKor"})],ut),f("click",n,()=>E(_)),B(j,n)}),B(e,s)},Bt=e=>{var s=Yt();B(e,s)};dt(St,e=>{t(b).length?e(At):e(Bt,!1)})}i(O);var rt=v(O,2);{var Kt=e=>{var s=Zt(),d=l(s),j=l(d,!0);i(d);var p=v(d,2),_=l(p);i(p);var n=v(p,2);let C;var P=l(n);i(n);var $=v(n,2),S=l($,!0);i($);var w=v($,2),N=l(w,!0);i(w);var x=v(w,2),V=l(x);i(x);var A=v(x,2),Q=l(A);i(A);var U=v(A,2);i(s),W(Tt=>{m(j,t(g)?"⏸":"▶"),m(_,`반복:${t(r)==="none"?"없음":t(r)==="one"?"문장":"전체"}`),C=X(n,1,"btn svelte-1g1oils",null,C,Tt),n.disabled=t(r)==="one",m(P,`횟수:${t(z)??""}x`),m(S,t(tt)),m(N,t(I)?"원문":"빈칸"),m(V,`음성:${t(et)??""}`),m(Q,`간격:${t(L)?H[t(L)]/1e3+"s":"즉시"}`)},[()=>({dis:t(r)==="one"})],ut),f("click",d,ht),f("click",p,kt),f("click",n,xt),f("click",$,wt),f("click",w,$t),f("click",x,yt),f("click",A,Et),f("click",U,lt),B(e,s)},Lt=e=>{var s=te();f("click",s,lt),B(e,s)};dt(rt,e=>{t(M)?e(Kt):e(Lt,!1)})}var Mt=v(rt,2);Vt(Mt,e=>a(c,e),()=>t(c)),W(()=>Pt(O,`bottom:${t(Z)}`)),B(pt,it),Dt(),_t()}export{_e as component};
