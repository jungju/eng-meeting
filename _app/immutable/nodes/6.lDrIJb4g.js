import"../chunks/NZTpNUN0.js";import{i as Ve}from"../chunks/tEBiHiVF.js";import{q as Ye,D as l,F as Ze,u as g,G as de,v as f,w as et,g as e,z as x,s as a,m as s,I as tt,P as at,M as qe,y as p,x as d,Q as st,A as R,C as L,K as J,J as nt,B as rt}from"../chunks/CwV636Gc.js";import{i as G}from"../chunks/BpFCBlOt.js";import{s as lt,e as ot,i as it}from"../chunks/lfAz8Y32.js";import{b as ct}from"../chunks/S5asknXf.js";import{s as vt,a as pt}from"../chunks/C3Q7PnuQ.js";import{o as dt,a as ft}from"../chunks/Dcbe9JOZ.js";import{p as ut}from"../chunks/B8zoCcxA.js";import{b as gt}from"../chunks/3tUvlbEd.js";import{C as _t}from"../chunks/D51qih5w.js";var mt=g('<div class="remain-big svelte-vlwcqt"> </div>'),ht=g('<p class="placeholder svelte-vlwcqt">•••</p>'),bt=g('<p class="kor svelte-vlwcqt"> </p>'),wt=g('<p class="eng svelte-vlwcqt"> </p>'),kt=g('<p class="eng svelte-vlwcqt"> </p>'),xt=g('<div role="button" tabindex="0"><div class="order-big svelte-vlwcqt"> </div> <!> <!></div> <button class="next-btn svelte-vlwcqt">NEXT ⏭</button>',1),yt=g('<div class="result-item svelte-vlwcqt" role="button" tabindex="0"><span class="num svelte-vlwcqt"></span> <span class="eng txt svelte-vlwcqt"> </span> <span class="kor txt svelte-vlwcqt"> </span></div>'),qt=g('<div class="result-list svelte-vlwcqt"><h2 class="svelte-vlwcqt">재생 순서 (클릭·Enter로 다시 듣기)</h2> <!></div>'),$t=g('<main class="wrapper svelte-vlwcqt"><!></main> <!> <audio playsinline="" preload="auto" class="svelte-vlwcqt"></audio>',1);function Kt($e,Ie){Ye(Ie,!1);const[Se,Le]=vt(),fe=()=>pt(ut,"$page",Se),ee=s(),E=s(),ue=s(),ge=s(),_=s(),u=s(),_e=s(),te=s(),P=s(),ae=s(),se=s(),ne=s(),re=s(),me=s(),he=[1e4,2e4,3e4,-1],be=[10,20,50,-1];let Q=s(0),X=s(0),m=s([]),le=s([]),c=s(-1),V=s(0),o=s(),h=s(!1),b=s(!1),A=!1,D=s(0),C,H=s(!1),y=s(!0),N=s(!1),v=s(0);const w=new Set;let q=s([]);dt(()=>(fetch(`${e(E)}/sentences.json`).then(t=>t.ok&&t.json()).then(t=>{t&&(a(m,t.sentences),a(le,t.korean))}),window.addEventListener("keydown",we),()=>window.removeEventListener("keydown",we))),ft(()=>{e(o)?.pause(),clearInterval(C)});function we(t){if(!e(H)){if(["Space","ArrowRight"].includes(t.code))t.preventDefault(),$();else if(t.code==="ArrowLeft"&&e(q).length>1){t.preventDefault();const n=e(q).pop();n!==void 0&&w.delete(n),a(V,e(q).length),T(e(q).at(-1),!1)}}}function Ee(){if(e(u)>=0&&w.size>=e(u)||w.size===e(m).length)return-1;let t;do t=Math.floor(Math.random()*e(m).length);while(w.has(t));return t}async function T(t,n=!0){if(!(t<0||t>=e(m).length)){n&&tt(V),a(c,t),w.add(t),n&&e(q).push(t),await at(),e(o).pause(),qe(o,e(o).src=`${e(_e)==="kor"?e(ge):e(ue)}/${String(t+1).padStart(2,"0")}.mp3`);try{await e(o).play(),a(h,!0)}catch{A=!0}}}function Ae(){e(o)&&qe(o,e(o).onended=()=>{if(a(h,!1),A){A=!1,$();return}e(u)>=0&&w.size>=e(u)||e(u)<0&&w.size===e(m).length||e(_)>=0&&De()})}function De(){e(_)<0||(e(b)&&clearInterval(C),a(b,!0),a(D,Math.ceil(e(_)/1e3)),C=setInterval(()=>{st(D,-1)<=0&&(clearInterval(C),a(b,!1),e(h)?A=!0:$())},1e3))}function $(){e(o).pause(),clearInterval(C),a(h,a(b,A=!1)),a(D,0);const t=Ee();if(t===-1){a(H,!0);return}T(t,!0)}const Ce=(t,n)=>n===1?"_".repeat(t.length):n===2?t[0]+"_".repeat(t.length-1):t,ze=t=>e(v)===4?t:e(v)===3?t.split(" ").map((n,i)=>i%2?"_".repeat(n.length):n).join(" "):e(v)>0?t.split(" ").map(n=>Ce(n,e(v))).join(" "):"";function z(){e(o).pause(),clearInterval(C),a(h,a(b,A=!1)),a(c,-1),a(V,a(D,0)),w.clear(),a(q,[]),a(H,!1)}function Me(){e(h)||e(b)||e(H)?z():$()}function je(){z(),a(X,(e(X)+1)%be.length)}function Be(t=!1){z(),a(v,(e(v)+(t?-1:1)+5)%5)}function Ke(){z(),a(y,!e(y))}function Oe(){a(N,!e(N))}function Re(){z(),a(Q,(e(Q)+1)%he.length)}const ke=t=>T(t,!1);function Ge(t){const{id:n,backward:i=!1}=t.detail;switch(n){case"start":Me();break;case"count":je();break;case"hint":Be(i);break;case"lang":Ke();break;case"hide":Oe();break;case"gap":Re();break}}l(()=>fe(),()=>{a(ee,fe().params.id)}),l(()=>e(ee),()=>{a(E,`${gt}/assets/sentence/${e(ee)}`)}),l(()=>e(E),()=>{a(ue,`${e(E)}/audio`)}),l(()=>e(E),()=>{a(ge,`${e(E)}/audiok`)}),l(()=>e(Q),()=>{a(_,he[e(Q)])}),l(()=>e(X),()=>{a(u,be[e(X)])}),l(()=>e(y),()=>{a(_e,e(y)?"kor":"eng")}),l(()=>e(o),()=>{e(o)&&Ae()}),l(()=>e(u),()=>{a(te,e(u)<0?"전체":`${e(u)}개`)}),l(()=>(e(h),e(b)),()=>{a(P,e(h)||e(b))}),l(()=>e(_),()=>{a(ae,e(_)<0?"∞":`${e(_)/1e3}s`)}),l(()=>e(v),()=>{a(se,`H${e(v)}`)}),l(()=>e(y),()=>{a(ne,e(y)?"한":"영")}),l(()=>e(N),()=>{a(re,e(N)?"보기":"가리기")}),l(()=>(e(P),e(te),e(se),e(v),e(ne),e(re),e(ae)),()=>{a(me,[{id:"start",icon:e(P)?"⏹":"▶"},{id:"count",text:`출제:${e(te)}`},{id:"hint",text:e(se),active:e(v)>0},{id:"lang",text:e(ne)},{id:"hide",text:e(re)},{id:"gap",text:e(ae)}])}),Ze(),Ve();var xe=$t(),oe=de(xe),He=p(oe);{var Ne=t=>{var n=xt(),i=de(n),U=p(i),M=p(U,!0);d(U);var Y=x(U,2);{var I=r=>{var k=mt(),j=p(k,!0);d(k),R(()=>L(j,e(D))),f(r,k)};G(Y,r=>{e(_)>=0&&e(D)>0&&r(I)})}var Z=x(Y,2);{var W=r=>{var k=nt(),j=de(k);{var We=B=>{var ce=ht();f(B,ce)},Fe=(B,ce)=>{{var Je=K=>{var F=bt(),ve=p(F,!0);d(F),R(()=>L(ve,e(le)[e(c)])),f(K,F)},Pe=(K,F)=>{{var ve=O=>{var S=wt(),pe=p(S,!0);d(S),R(Xe=>L(pe,Xe),[()=>ze(e(m)[e(c)])],rt),f(O,S)},Qe=O=>{var S=kt(),pe=p(S,!0);d(S),R(()=>L(pe,e(m)[e(c)])),f(O,S)};G(K,O=>{e(v)>0?O(ve):O(Qe,!1)},F)}};G(B,K=>{e(y)?K(Je):K(Pe,!1)},ce)}};G(j,B=>{e(N)?B(We):B(Fe,!1)})}f(r,k)};G(Z,r=>{e(c)!==-1&&r(W)})}d(i);var ie=x(i,2);R(()=>{lt(i,1,`sentence-box ${e(P)?"playing":""}`,"svelte-vlwcqt"),L(M,e(c)===-1?"Ready":`#${e(V)}`)}),J("click",i,function(...r){(e(c)===-1?$:()=>T(e(c),!1))?.apply(this,r)}),J("keydown",i,r=>["Enter"," "].includes(r.key)&&(r.preventDefault(),e(c)===-1?$():T(e(c),!1))),J("click",ie,$),f(t,n)},Te=t=>{var n=qt(),i=x(p(n),2);ot(i,1,()=>e(q),it,(U,M,Y)=>{var I=yt(),Z=p(I);Z.textContent=`${Y+1}.`;var W=x(Z,2),ie=p(W,!0);d(W);var r=x(W,2),k=p(r,!0);d(r),d(I),R(()=>{L(ie,e(m)[e(M)]),L(k,e(le)[e(M)])}),J("click",I,()=>ke(e(M))),J("keydown",I,j=>["Enter"," "].includes(j.key)&&(j.preventDefault(),ke(e(M)))),f(U,I)}),d(n),f(t,n)};G(He,t=>{e(H)?t(Te,!1):t(Ne)})}d(oe);var ye=x(oe,2);_t(ye,{get buttons(){return e(me)},$$events:{click:Ge}});var Ue=x(ye,2);ct(Ue,t=>a(o,t),()=>e(o)),f($e,xe),et(),Le()}export{Kt as component};
