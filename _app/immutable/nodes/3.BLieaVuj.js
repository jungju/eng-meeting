import"../chunks/NZTpNUN0.js";import{i as Kt}from"../chunks/C1kFBjD0.js";import{p as Qt,a3 as S,a4 as Wt,t as _,f as C,a as c,b as Xt,g as t,d as s,o as r,e as f,r as n,s as u,a5 as X,h as k,i as w,c as Yt,a6 as Zt,m as Y,a7 as te}from"../chunks/kc4YAh9y.js";import{i as E}from"../chunks/meG6WkfV.js";import{e as kt,i as wt}from"../chunks/BvPctM3R.js";import{s as ee}from"../chunks/D8RCsmFZ.js";import{s as ae}from"../chunks/DBe_9k9b.js";import{b as re}from"../chunks/eT6sziqz.js";import{s as se,a as oe}from"../chunks/CxXm-2W8.js";import{o as ne}from"../chunks/B6AwUu_V.js";import{b as ie}from"../chunks/C6shGu5A.js";import{p as le}from"../chunks/BvS9LoP3.js";import{C as ce}from"../chunks/Dw7rxz5s.js";var ve=_('<div class="timer svelte-1daikbg"> </div>'),de=_("<span></span> ",1),fe=_('<span class="revealed correct-word svelte-1daikbg"> </span> ',1),me=_('<span class="revealed wrong-word svelte-1daikbg"> </span> ',1),pe=_('<p class="kor svelte-1daikbg"> </p> <p class="eng svelte-1daikbg"></p>',1),he=_('<button class="choice-btn svelte-1daikbg"> </button>'),ue=_('<div class="choices svelte-1daikbg"></div>'),_e=_('<div class="sentence-box svelte-1daikbg"><div class="order-big svelte-1daikbg"> </div> <!> <!></div> <!>',1),ge=_('<div class="result-list svelte-1daikbg"><h2 class="svelte-1daikbg"> </h2> <h2 class="svelte-1daikbg"> </h2></div>'),be=_('<main class="wrapper svelte-1daikbg"><!></main> <!> <audio playsinline="" preload="auto" class="svelte-1daikbg"></audio>',1);function je(Mt,$t){Qt($t,!1);const[St,yt]=se(),vt=()=>oe(le,"$page",St),Z=s(),D=s(),Bt=s(),z=s(),g=s(),dt=s(),ft=s(),mt=s(),pt=[10,20,50,-1],ht=[10,30,-1],It=/[.,!?]/g;let L=s(0),q=s(0),P=[],ut=s([]),tt=[],i=s([]),b=s([]),_t=s(),m=s(-1),et=s(0),at=s(!1),y=s(0),U=s(0),B=s(0),j=s(0),F;const V=new Set,H=e=>e.replace(It,""),Tt=e=>{for(let a=e.length-1;a>0;a--){const o=Math.floor(Math.random()*(a+1));[e[a],e[o]]=[e[o],e[a]]}return e},Ct=()=>{if(t(z)>=0&&V.size>=t(z)||V.size===P.length)return-1;let e;do e=Math.floor(Math.random()*P.length);while(V.has(e));return e};ne(async()=>{const e=await fetch(`${t(D)}/sentences.json`);if(!e.ok)return;const a=await e.json();P=a.sentences,r(ut,a.korean),tt=[...new Set(P.flatMap(o=>o.split(" ").map(H)))]});function Et(){J(),!(t(g)<0)&&(r(j,t(g)),F=setInterval(()=>{X(j,-1),t(j)<=0&&(J(),rt())},1e3))}function J(){F&&clearInterval(F),F=void 0}function zt(e){const a=P[e].split(" "),o=new Set,p=Math.min(4,3+Math.floor(Math.random()*2));for(;o.size<Math.min(p,a.length);)o.add(Math.floor(Math.random()*a.length));r(b,[...o].map(l=>{const v=H(a[l]),x=new Set([v]);for(;x.size<10;)x.add(tt[Math.floor(Math.random()*tt.length)]);return{index:l,choices:Tt([...x])}}).sort((l,v)=>l.index-v.index)),r(i,a.map((l,v)=>{const x=o.has(v);return{text:l,isBlank:x,active:x&&v===t(b)[0].index,len:x?Math.max(H(l).length,3):0,result:void 0}})),r(y,0),Et()}function rt(){const e=Ct();if(e===-1){r(at,!0),J();return}r(m,e),X(et),V.add(e),zt(e),r(B,t(B)+t(b).length)}function jt(e){const{index:a}=t(b)[t(y)],o=H(t(i)[a].text),p=e===o;p&&X(U),Y(i,t(i)[a].isBlank=!1),Y(i,t(i)[a].active=!1),Y(i,t(i)[a].result=p?"correct":"wrong"),X(y),t(y)<t(b).length?Y(i,t(i)[t(b)[t(y)].index].active=!0):rt()}function st(){J(),r(m,-1),r(et,r(U,r(B,r(j,0)))),r(at,!1),V.clear(),r(i,[]),r(b,[])}function At(e){const{id:a}=e.detail;a==="start"&&(t(m)===-1?rt():st()),a==="count"&&(r(L,(t(L)+1)%pt.length),st()),a==="time"&&(r(q,(t(q)+1)%ht.length),st())}S(()=>vt(),()=>{r(Z,vt().params.id)}),S(()=>t(Z),()=>{r(D,`${ie}/assets/sentence/${t(Z)}`)}),S(()=>t(D),()=>{r(Bt,`${t(D)}/audio`)}),S(()=>t(L),()=>{r(z,pt[t(L)])}),S(()=>t(q),()=>{r(g,ht[t(q)])}),S(()=>(t(B),t(U)),()=>{r(dt,t(B)?Math.round(t(U)/t(B)*100):0)}),S(()=>(t(g),t(j)),()=>{r(ft,t(g)<0?"∞":`${t(j)}s`)}),S(()=>(t(m),t(z),t(g)),()=>{r(mt,[{id:"start",icon:t(m)===-1?"▶":"⏹"},{id:"count",text:t(z)<0?"전체":`${t(z)}개`},{id:"time",text:t(g)<0?"∞":`${t(g)}s`}])}),Wt(),Kt();var gt=be(),ot=C(gt),Nt=f(ot);{var Pt=e=>{var a=_e(),o=C(a),p=f(o),l=f(p,!0);n(p);var v=u(p,2);{var x=d=>{var h=ve(),I=f(h);n(h),k(()=>w(I,`⏱ ${t(ft)??""}`)),c(d,h)};E(v,d=>{t(g)>=0&&t(m)!==-1&&d(x)})}var Gt=u(v,2);{var Ot=d=>{var h=pe(),I=C(h),K=f(I,!0);n(I);var T=u(I,2);kt(T,5,()=>t(i),wt,(nt,M)=>{var xt=Yt(),Lt=C(xt);{var qt=A=>{var Q=de(),G=C(Q),it=u(G,1,!0);it.nodeValue=" ",k(()=>{ee(G,1,`blank ${t(M).active?"highlight":""}`,"svelte-1daikbg"),ae(G,`width:${t(M).len??""}ch;`)}),c(A,Q)},Ft=(A,Q)=>{{var G=N=>{var W=fe(),O=C(W),lt=f(O,!0);n(O);var $=u(O,1,!0);$.nodeValue=" ",k(()=>w(lt,t(M).text)),c(N,W)},it=(N,W)=>{{var O=$=>{var R=me(),ct=C(R),Ht=f(ct,!0);n(ct);var Jt=u(ct,1,!0);Jt.nodeValue=" ",k(()=>w(Ht,t(M).text)),c($,R)},lt=$=>{var R=te();k(()=>w(R,`${t(M).text??""} `)),c($,R)};E(N,$=>{t(M).result==="wrong"?$(O):$(lt,!1)},W)}};E(A,N=>{t(M).result==="correct"?N(G):N(it,!1)},Q)}};E(Lt,A=>{t(M).isBlank?A(qt):A(Ft,!1)})}c(nt,xt)}),n(T),k(()=>w(K,t(ut)[t(m)])),c(d,h)};E(Gt,d=>{t(m)!==-1&&d(Ot)})}n(o);var Rt=u(o,2);{var Dt=d=>{var h=ue();kt(h,5,()=>t(b)[t(y)].choices,wt,(I,K)=>{var T=he(),nt=f(T,!0);n(T),k(()=>w(nt,t(K))),Zt("click",T,()=>jt(t(K))),c(I,T)}),n(h),c(d,h)};E(Rt,d=>{t(m)!==-1&&t(y)<t(b).length&&d(Dt)})}k(()=>w(l,t(m)===-1?"Ready":`#${t(et)}`)),c(e,a)},Ut=e=>{var a=ge(),o=f(a),p=f(o);n(o);var l=u(o,2),v=f(l);n(l),n(a),k(()=>{w(p,`정답 : ${t(U)??""} / ${t(B)??""}`),w(v,`점수 : ${t(dt)??""}점`)}),c(e,a)};E(Nt,e=>{t(at)?e(Ut,!1):e(Pt)})}n(ot);var bt=u(ot,2);ce(bt,{get buttons(){return t(mt)},$$events:{click:At}});var Vt=u(bt,2);re(Vt,e=>r(_t,e),()=>t(_t)),c(Mt,gt),Xt(),yt()}export{je as component};
